{% extends "base.html" %}

{% block title %}–ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª–∏ - –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å{% endblock %}

{% block page_title %}üë• –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—è–º–∏{% endblock %}

{% block extra_css %}
<style>
.contractor-card {
    border: none;
    border-radius: 15px;
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    transition: transform 0.2s, box-shadow 0.2s;
    margin-bottom: 20px;
    height: auto;
    min-height: 400px;
    display: flex;
    flex-direction: column;
}

.contractor-card:hover {
    transform: translateY(-2px);
    box-shadow: 0 6px 12px rgba(0, 0, 0, 0.15);
}

.contractor-header {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    color: white;
    border-radius: 15px 15px 0 0;
    padding: 20px;
    min-height: 120px;
    display: flex;
    align-items: center;
}

.contractor-info {
    padding: 20px;
    flex: 1;
    display: flex;
    flex-direction: column;
    justify-content: space-between;
}

.contractor-stats {
    display: flex;
    justify-content: space-around;
    padding: 15px;
    background: #f8f9fa;
    border-radius: 0 0 15px 15px;
    margin-top: auto;
}

.stat-item {
    text-align: center;
    flex: 1;
    padding: 0 5px;
}

.stat-value {
    font-size: 1.2rem;
    font-weight: bold;
    color: #495057;
    line-height: 1.2;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}

.stat-label {
    font-size: 0.75rem;
    color: #6c757d;
    line-height: 1.2;
    margin-top: 2px;
}

.specialization-badge {
    background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
    color: white;
    padding: 4px 12px;
    border-radius: 20px;
    font-size: 0.875rem;
    font-weight: 500;
}

.contract-type-badge {
    padding: 4px 8px;
    border-radius: 10px;
    font-size: 0.75rem;
    font-weight: 500;
}

.contract-freelance {
    background: #e7f3ff;
    color: #0066cc;
}

.contract-employee {
    background: #e8f5e8;
    color: #28a745;
}

.contract-agency {
    background: #fff3cd;
    color: #856404;
}

.rating-stars {
    color: #ffc107;
}

.payment-status {
    padding: 4px 8px;
    border-radius: 10px;
    font-size: 0.75rem;
    font-weight: 500;
}

.status-pending {
    background: #fff3cd;
    color: #856404;
}

.status-paid {
    background: #d4edda;
    color: #155724;
}

.status-overdue {
    background: #f8d7da;
    color: #721c24;
}

.assignment-item {
    border-left: 4px solid #dee2e6;
    padding: 15px;
    margin-bottom: 10px;
    background: #f8f9fa;
    border-radius: 8px;
}

.assignment-active {
    border-left-color: #007bff;
}

.assignment-completed {
    border-left-color: #28a745;
}

.filter-section {
    background: #f8f9fa;
    border-radius: 10px;
    padding: 20px;
    margin-bottom: 20px;
}

/* –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Å—Ç–∏–ª–∏ –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è */
.contractor-card .contractor-info .row {
    margin-bottom: 10px;
}

.contractor-card .contractor-info .col-6 {
    padding-left: 5px;
    padding-right: 5px;
}

.contractor-card .contractor-info small {
    font-size: 0.75rem;
    font-weight: 600;
}

.contractor-card .contractor-info span {
    font-size: 0.85rem;
    line-height: 1.3;
    word-wrap: break-word;
    overflow-wrap: break-word;
}

.contractor-card .p-3.border-top .btn {
    font-size: 0.75rem;
    padding: 4px 8px;
    white-space: nowrap;
}

.contractor-card .p-3.border-top {
    margin-top: auto;
    padding: 15px !important;
}

.contractor-card h5 {
    font-size: 1.1rem;
    line-height: 1.3;
    margin-bottom: 8px;
    word-wrap: break-word;
    overflow-wrap: break-word;
}

.specialization-badge, .contract-type-badge {
    font-size: 0.7rem;
    white-space: nowrap;
}

/* –ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤ */
@media (max-width: 768px) {
    .contractor-card {
        min-height: auto;
    }
    
    .contractor-card .contractor-info .row {
        margin-bottom: 8px;
    }
    
    .contractor-card .p-3.border-top .d-flex {
        flex-wrap: wrap;
        gap: 5px;
    }
    
    .contractor-card .p-3.border-top .btn {
        font-size: 0.7rem;
        padding: 3px 6px;
    }
}
</style>

<script>
console.log('=== –°–ö–†–ò–ü–¢ CONTRACTORS –ù–ê–ß–ò–ù–ê–ï–¢ –ó–ê–ì–†–£–ñ–ê–¢–¨–°–Ø ===');

// –ì–õ–û–ë–ê–õ–¨–ù–´–ï –ü–ï–†–ï–ú–ï–ù–ù–´–ï
const adminUsername = 'admin';
const adminPassword = 'qwerty123';
let currentPage = 1;
let currentContractorId = null;
const itemsPerPage = 12;

console.log('–ì–ª–æ–±–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω—ã:', {
    adminUsername,
    adminPassword,
    currentPage,
    itemsPerPage
});

console.log('–ü—Ä–æ–≤–µ—Ä—è–µ–º showNotification...');
// –§–£–ù–ö–¶–ò–Ø –£–í–ï–î–û–ú–õ–ï–ù–ò–ô - –ó–ê–ì–õ–£–®–ö–ê –ù–ê –°–õ–£–ß–ê–ô –ï–°–õ–ò –ù–ï –ó–ê–ì–†–£–ñ–ï–ù–ê –ò–ó BASE.HTML
if (typeof showNotification === 'undefined') {
    console.log('showNotification –Ω–µ –Ω–∞–π–¥–µ–Ω, —Å–æ–∑–¥–∞–µ–º –∑–∞–≥–ª—É—à–∫—É');
    function showNotification(message, type = 'success') {
        console.log(`[${type.toUpperCase()}] ${message}`);
        alert(message);
    }
} else {
    console.log('showNotification —É–∂–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω');
}
console.log('showNotification –ø—Ä–æ–≤–µ—Ä–µ–Ω —É—Å–ø–µ—à–Ω–æ');

console.log('–û–ø—Ä–µ–¥–µ–ª—è–µ–º —Ñ—É–Ω–∫—Ü–∏—é updatePagination...');
// –§–£–ù–ö–¶–ò–Ø –ü–ê–ì–ò–ù–ê–¶–ò–ò - –û–ü–†–ï–î–ï–õ–Ø–ï–ú –í –ù–ê–ß–ê–õ–ï
function updatePagination(currentPage, totalPages, totalItems) {
    const pagination = document.getElementById('pagination');
    let paginationHtml = '';
    
    if (totalPages > 1) {
        // –ü—Ä–µ–¥—ã–¥—É—â–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞
        if (currentPage > 1) {
            paginationHtml += `<li class="page-item"><a class="page-link" href="#" onclick="loadContractors(${currentPage - 1})">‚Äπ</a></li>`;
        }
        
        // –ù–æ–º–µ—Ä–∞ —Å—Ç—Ä–∞–Ω–∏—Ü
        for (let i = 1; i <= totalPages; i++) {
            if (i === currentPage) {
                paginationHtml += `<li class="page-item active"><span class="page-link">${i}</span></li>`;
            } else {
                paginationHtml += `<li class="page-item"><a class="page-link" href="#" onclick="loadContractors(${i})">${i}</a></li>`;
            }
        }
        
        // –°–ª–µ–¥—É—é—â–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞
        if (currentPage < totalPages) {
            paginationHtml += `<li class="page-item"><a class="page-link" href="#" onclick="loadContractors(${currentPage + 1})">‚Ä∫</a></li>`;
        }
    }
    
    pagination.innerHTML = paginationHtml;
}
console.log('–§—É–Ω–∫—Ü–∏—è updatePagination –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∞ —É—Å–ø–µ—à–Ω–æ');

console.log('–û–ø—Ä–µ–¥–µ–ª—è–µ–º —Ñ—É–Ω–∫—Ü–∏—é openContractorModal...');
// –ì–ª–æ–±–∞–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –æ—Ç–∫—Ä—ã—Ç–∏—è –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ - –û–ü–†–ï–î–ï–õ–Ø–ï–ú –í HEAD
function openContractorModal() {
    console.log('–§—É–Ω–∫—Ü–∏—è openContractorModal –≤—ã–∑–≤–∞–Ω–∞');
    const modalElement = document.getElementById('addContractorModal');
    console.log('–ù–∞–π–¥–µ–Ω–æ –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ:', modalElement);
    
    if (modalElement) {
        if (typeof bootstrap !== 'undefined') {
            console.log('Bootstrap –¥–æ—Å—Ç—É–ø–µ–Ω, —Å–æ–∑–¥–∞–µ–º –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ');
            const modal = new bootstrap.Modal(modalElement);
            modal.show();
        } else {
            console.error('Bootstrap –Ω–µ –Ω–∞–π–¥–µ–Ω');
        }
    } else {
        console.error('–ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ');
    }
}
console.log('–§—É–Ω–∫—Ü–∏—è openContractorModal –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∞ —É—Å–ø–µ—à–Ω–æ');

console.log('–û–ø—Ä–µ–¥–µ–ª—è–µ–º —Ñ—É–Ω–∫—Ü–∏—é loadContractors...');
// –ì–õ–ê–í–ù–ê–Ø –§–£–ù–ö–¶–ò–Ø - –ó–ê–ì–†–£–ó–ö–ê –ò–°–ü–û–õ–ù–ò–¢–ï–õ–ï–ô - –û–ü–†–ï–î–ï–õ–Ø–ï–ú –í HEAD
async function loadContractors(page = 1) {
    console.log('loadContractors –≤—ã–∑–≤–∞–Ω, page:', page);
    try {
        const searchFilter = document.getElementById('searchFilter');
        const specializationFilter = document.getElementById('specializationFilter');
        const statusFilter = document.getElementById('statusFilter');
        
        console.log('–≠–ª–µ–º–µ–Ω—Ç—ã —Ñ–∏–ª—å—Ç—Ä–æ–≤ –Ω–∞–π–¥–µ–Ω—ã:', {
            searchFilter: !!searchFilter,
            specializationFilter: !!specializationFilter,
            statusFilter: !!statusFilter
        });
        
        const searchParams = new URLSearchParams({
            page: page,
            limit: 12,
            search: searchFilter ? searchFilter.value : '',
            specialization: specializationFilter ? specializationFilter.value : '',
            status: statusFilter ? statusFilter.value : ''
        });
        
        const url = `/admin/api/contractors/?${searchParams}`;
        console.log('–ó–∞–ø—Ä–æ—Å –∫ URL:', url);
        
        const response = await fetch(url, {
            headers: {
                'Authorization': 'Basic ' + btoa('admin:qwerty123')
            }
        });
        
        console.log('Response status:', response.status);
        console.log('Response ok:', response.ok);
        
        const data = await response.json();
        console.log('–î–∞–Ω–Ω—ã–µ –æ—Ç–≤–µ—Ç–∞:', data);
        
        if (data.success) {
            console.log('–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª–µ–π:', data.data.length);
            displayContractors(data.data);
            // –û–±–Ω–æ–≤–ª—è–µ–º –ø–∞–≥–∏–Ω–∞—Ü–∏—é
            updatePagination(page, Math.ceil(data.total / 12), data.total);
        } else {
            console.error('API –≤–µ—Ä–Ω—É–ª –æ—à–∏–±–∫—É:', data.message);
            showNotification('–û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª–µ–π: ' + data.message, 'danger');
        }
    } catch (error) {
        console.error('–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞ loadContractors:', error);
        showNotification('–û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª–µ–π: ' + error.message, 'danger');
    }
}
console.log('–§—É–Ω–∫—Ü–∏—è loadContractors –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∞ —É—Å–ø–µ—à–Ω–æ');

console.log('–û–ø—Ä–µ–¥–µ–ª—è–µ–º —Ñ—É–Ω–∫—Ü–∏—é displayContractors...');
// –ì–õ–ê–í–ù–ê–Ø –§–£–ù–ö–¶–ò–Ø - –û–¢–û–ë–†–ê–ñ–ï–ù–ò–ï –ò–°–ü–û–õ–ù–ò–¢–ï–õ–ï–ô - –û–ü–†–ï–î–ï–õ–Ø–ï–ú –í HEAD
function displayContractors(contractors) {
    console.log('=== –í–ù–£–¢–†–ò displayContractors ===');
    console.log('=== –ù–ê–ß–ê–õ–û displayContractors ===');
    console.log('displayContractors –≤—ã–∑–≤–∞–Ω —Å –¥–∞–Ω–Ω—ã–º–∏:', contractors);
    console.log('–¢–∏–ø –¥–∞–Ω–Ω—ã—Ö:', typeof contractors);
    console.log('–Ø–≤–ª—è–µ—Ç—Å—è –ª–∏ –º–∞—Å—Å–∏–≤–æ–º:', Array.isArray(contractors));
    console.log('–î–ª–∏–Ω–∞:', contractors ? contractors.length : 'contractors is null/undefined');
    console.log('–ü–´–¢–ê–ï–ú–°–Ø –ù–ê–ô–¢–ò contractorsList...');
    
    const contractorsList = document.getElementById('contractorsList');
    console.log('–≠–ª–µ–º–µ–Ω—Ç contractorsList –Ω–∞–π–¥–µ–Ω:', !!contractorsList);
    console.log('–ü–û–°–õ–ï –ü–û–ò–°–ö–ê contractorsList');
    
    if (!contractors || contractors.length === 0) {
        console.log('–ù–µ—Ç –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª–µ–π –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è - –ø–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ');
        if (contractorsList) {
            contractorsList.innerHTML = '<div class="col-12"><div class="alert alert-info">–ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã</div></div>';
        }
        return;
    }
    
    console.log('–°—Ç—Ä–æ–∏–º HTML –¥–ª—è –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª–µ–π...');
    
    const containerHtml = contractors.map(contractor => {
        // –°–æ–∑–¥–∞–µ–º –æ—Ç–æ–±—Ä–∞–∂–∞–µ–º–æ–µ –∏–º—è –∏–∑ username –∏–ª–∏ first_name + last_name
        const displayName = contractor.first_name && contractor.last_name 
            ? `${contractor.first_name} ${contractor.last_name}` 
            : contractor.username;
        
        return `
        <div class="col-lg-4 col-md-6">
            <div class="contractor-card">
                <div class="contractor-header">
                    <div class="d-flex justify-content-between align-items-start">
                        <div>
                            <h5 class="mb-1">${displayName}</h5>
                            <div class="d-flex gap-2 mb-2">
                                <span class="specialization-badge">–ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å</span>
                                <span class="contract-type-badge contract-freelance">–§—Ä–∏–ª–∞–Ω—Å</span>
                            </div>
                        </div>
                        <div class="text-end">
                            <div class="rating-stars">
                                ‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ
                            </div>
                            <small>5/5</small>
                        </div>
                    </div>
                </div>
                <div class="contractor-info">
                    <div class="row">
                        <div class="col-6">
                            <small class="text-muted">Email:</small><br>
                            <span>${contractor.email || '–ù–µ —É–∫–∞–∑–∞–Ω'}</span>
                        </div>
                        <div class="col-6">
                            <small class="text-muted">Username:</small><br>
                            <span>${contractor.username || '–ù–µ —É–∫–∞–∑–∞–Ω'}</span>
                        </div>
                    </div>
                    <div class="row mt-2">
                        <div class="col-6">
                            <small class="text-muted">–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è:</small><br>
                            <span>${contractor.created_at ? new Date(contractor.created_at).toLocaleDateString('ru-RU') : '–ù–µ —É–∫–∞–∑–∞–Ω–∞'}</span>
                        </div>
                        <div class="col-6">
                            <small class="text-muted">–°—Ç–∞—Ç—É—Å:</small><br>
                            <span class="badge ${contractor.is_active ? 'bg-success' : 'bg-secondary'}">
                                ${contractor.is_active ? '–ê–∫—Ç–∏–≤–µ–Ω' : '–ù–µ–∞–∫—Ç–∏–≤–µ–Ω'}
                            </span>
                        </div>
                    </div>
                </div>
                <div class="contractor-stats">
                    <div class="stat-item">
                        <div class="stat-value">0</div>
                        <div class="stat-label">–ü—Ä–æ–µ–∫—Ç–æ–≤</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value">0</div>
                        <div class="stat-label">–ê–∫—Ç–∏–≤–Ω—ã—Ö</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value">${contractor.total_payments ? contractor.total_payments.toLocaleString('ru-RU') + '‚ÇΩ' : '0‚ÇΩ'}</div>
                        <div class="stat-label">–í—ã–ø–ª–∞—á–µ–Ω–æ</div>
                    </div>
                </div>
                <div class="p-3 border-top">
                    <div class="d-flex justify-content-between flex-wrap gap-1">
                        <button class="btn btn-sm btn-outline-primary" onclick="viewContractor(${contractor.id})">
                            <i class="fas fa-eye"></i> –î–µ—Ç–∞–ª–∏
                        </button>
                        <button class="btn btn-sm btn-outline-success" onclick="createPayment(${contractor.id})">
                            <i class="fas fa-money-bill"></i> –í—ã–ø–ª–∞—Ç–∞
                        </button>
                        <button class="btn btn-sm btn-outline-warning" onclick="editContractor(${contractor.id})">
                            <i class="fas fa-edit"></i> –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å
                        </button>
                        <button class="btn btn-sm btn-outline-danger" onclick="deleteContractor(${contractor.id})" title="–£–¥–∞–ª–∏—Ç—å –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—è">
                            <i class="fas fa-trash"></i> –£–¥–∞–ª–∏—Ç—å
                        </button>
                    </div>
                </div>
            </div>
        </div>
    `;
    }).join('');
    
    console.log('HTML –ø–æ—Å—Ç—Ä–æ–µ–Ω, –¥–ª–∏–Ω–∞:', containerHtml.length);
    console.log('–ó–∞–ø–∏—Å—ã–≤–∞–µ–º HTML –≤ contractorsList...');
    if (contractorsList) {
        contractorsList.innerHTML = containerHtml;
        console.log('HTML –∑–∞–ø–∏—Å–∞–Ω —É—Å–ø–µ—à–Ω–æ');
    } else {
        console.error('contractorsList —ç–ª–µ–º–µ–Ω—Ç –Ω–µ –Ω–∞–π–¥–µ–Ω!');
    }
    console.log('=== –ö–û–ù–ï–¶ displayContractors ===');
}
console.log('–§—É–Ω–∫—Ü–∏—è displayContractors –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∞ —É—Å–ø–µ—à–Ω–æ');

// –û–ü–†–ï–î–ï–õ–Ø–ï–ú –í–°–ï –§–£–ù–ö–¶–ò–ò –ö–ù–û–ü–û–ö –ü–ï–†–ï–î –ò–°–ü–û–õ–¨–ó–û–í–ê–ù–ò–ï–ú
console.log('–û–ø—Ä–µ–¥–µ–ª—è–µ–º —Ñ—É–Ω–∫—Ü–∏–∏ –∫–Ω–æ–ø–æ–∫...');

// –§—É–Ω–∫—Ü–∏—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –¥–µ—Ç–∞–ª–µ–π –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—è
async function viewContractor(contractorId) {
    try {
        console.log('–ü—Ä–æ—Å–º–æ—Ç—Ä –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—è:', contractorId);
        const response = await fetch(`/admin/api/contractors/${contractorId}`, {
            credentials: 'include'
        });
        
        const data = await response.json();
        
        if (data.success) {
            displayContractorDetails(data.contractor);
        } else {
            alert('–û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –¥–∞–Ω–Ω—ã—Ö –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—è: ' + data.message);
        }
    } catch (error) {
        console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø—Ä–æ—Å–º–æ—Ç—Ä–µ –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—è:', error);
        alert('–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø—Ä–æ—Å–º–æ—Ç—Ä–µ –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—è');
    }
}

// –§—É–Ω–∫—Ü–∏—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –¥–µ—Ç–∞–ª–µ–π –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—è
function displayContractorDetails(contractor) {
    const detailsHtml = `
        <div class="contractor-details">
            <h5>–î–µ—Ç–∞–ª–∏ –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—è</h5>
            <div class="row">
                <div class="col-md-6">
                    <p><strong>ID:</strong> ${contractor.id}</p>
                    <p><strong>–ò–º—è:</strong> ${contractor.first_name || '–ù–µ —É–∫–∞–∑–∞–Ω–æ'}</p>
                    <p><strong>–§–∞–º–∏–ª–∏—è:</strong> ${contractor.last_name || '–ù–µ —É–∫–∞–∑–∞–Ω–æ'}</p>
                    <p><strong>Email:</strong> ${contractor.email || '–ù–µ —É–∫–∞–∑–∞–Ω'}</p>
                </div>
                <div class="col-md-6">
                    <p><strong>Username:</strong> ${contractor.username || '–ù–µ —É–∫–∞–∑–∞–Ω'}</p>
                    <p><strong>–†–æ–ª—å:</strong> ${contractor.role || '–ù–µ —É–∫–∞–∑–∞–Ω–∞'}</p>
                    <p><strong>–°—Ç–∞—Ç—É—Å:</strong> ${contractor.is_active ? '–ê–∫—Ç–∏–≤–µ–Ω' : '–ù–µ–∞–∫—Ç–∏–≤–µ–Ω'}</p>
                    <p><strong>–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è:</strong> ${contractor.created_at ? new Date(contractor.created_at).toLocaleDateString('ru-RU') : '–ù–µ —É–∫–∞–∑–∞–Ω–∞'}</p>
                </div>
            </div>
        </div>
    `;
    
    // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –≤ –º–æ–¥–∞–ª—å–Ω–æ–º –æ–∫–Ω–µ
    const modalBody = document.querySelector('#contractorModal .modal-body');
    if (modalBody) {
        modalBody.innerHTML = detailsHtml;
        const modal = new bootstrap.Modal(document.getElementById('contractorModal'));
        modal.show();
    } else {
        alert(detailsHtml.replace(/<[^>]*>/g, ' '));
    }
}

// –§—É–Ω–∫—Ü–∏—è —Å–æ–∑–¥–∞–Ω–∏—è –≤—ã–ø–ª–∞—Ç—ã
function createPayment(contractorId) {
    console.log('–°–æ–∑–¥–∞–Ω–∏–µ –≤—ã–ø–ª–∞—Ç—ã –¥–ª—è –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—è:', contractorId);
    
    const amount = prompt('–í–≤–µ–¥–∏—Ç–µ —Å—É–º–º—É –≤—ã–ø–ª–∞—Ç—ã (–≤ —Ä—É–±–ª—è—Ö):');
    if (!amount || isNaN(amount) || parseFloat(amount) <= 0) {
        alert('–ù–µ–≤–µ—Ä–Ω–∞—è —Å—É–º–º–∞ –≤—ã–ø–ª–∞—Ç—ã');
        return;
    }
    
    const description = prompt('–í–≤–µ–¥–∏—Ç–µ –æ–ø–∏—Å–∞–Ω–∏–µ –≤—ã–ø–ª–∞—Ç—ã:') || '';
    
    if (confirm(`–°–æ–∑–¥–∞—Ç—å –≤—ã–ø–ª–∞—Ç—É ${amount}‚ÇΩ –¥–ª—è –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—è?`)) {
        fetch(`/admin/api/contractors/${contractorId}/payments`, {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            credentials: 'include',
            body: JSON.stringify({
                amount: parseFloat(amount),
                description: description
            })
        })
        .then(response => response.json())
        .then(data => {
            if (data.success) {
                alert('–í—ã–ø–ª–∞—Ç–∞ —É—Å–ø–µ—à–Ω–æ —Å–æ–∑–¥–∞–Ω–∞!');
                loadContractors(); // –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞–µ–º —Å–ø–∏—Å–æ–∫
            } else {
                alert('–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –≤—ã–ø–ª–∞—Ç—ã: ' + data.message);
            }
        })
        .catch(error => {
            console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –≤—ã–ø–ª–∞—Ç—ã:', error);
            alert('–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –≤—ã–ø–ª–∞—Ç—ã');
        });
    }
}

// –§—É–Ω–∫—Ü–∏—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—è
async function editContractor(contractorId) {
    try {
        console.log('–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—è:', contractorId);
        
        // –ó–∞–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—è
        const response = await fetch(`/admin/api/contractors/${contractorId}`, {
            credentials: 'include'
        });
        
        const data = await response.json();
        
        if (data.success) {
            showEditContractorModal(data.contractor);
        } else {
            alert('–û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –¥–∞–Ω–Ω—ã—Ö –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—è: ' + data.message);
        }
    } catch (error) {
        console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏ –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—è:', error);
        alert('–û—à–∏–±–∫–∞ –ø—Ä–∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏ –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—è');
    }
}

// –§—É–Ω–∫—Ü–∏—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
function showEditContractorModal(contractor) {
    const editModalHtml = `
        <div class="modal fade" id="editContractorModal" tabindex="-1">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title">–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—è</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                    </div>
                    <div class="modal-body">
                        <form id="editContractorForm">
                            <div class="mb-3">
                                <label class="form-label">–ò–º—è</label>
                                <input type="text" class="form-control" id="editFirstName" value="${contractor.first_name || ''}">
                            </div>
                            <div class="mb-3">
                                <label class="form-label">–§–∞–º–∏–ª–∏—è</label>
                                <input type="text" class="form-control" id="editLastName" value="${contractor.last_name || ''}">
                            </div>
                            <div class="mb-3">
                                <label class="form-label">Email</label>
                                <input type="email" class="form-control" id="editEmail" value="${contractor.email || ''}">
                            </div>
                            <div class="mb-3">
                                <label class="form-label">Username</label>
                                <input type="text" class="form-control" id="editUsername" value="${contractor.username || ''}">
                            </div>
                            <div class="mb-3">
                                <div class="form-check">
                                    <input type="checkbox" class="form-check-input" id="editIsActive" ${contractor.is_active ? 'checked' : ''}>
                                    <label class="form-check-label">–ê–∫—Ç–∏–≤–µ–Ω</label>
                                </div>
                            </div>
                        </form>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-warning" onclick="showChangePasswordModal(${contractor.id})">
                            <i class="fas fa-key"></i> –ò–∑–º–µ–Ω–∏—Ç—å –ø–∞—Ä–æ–ª—å
                        </button>
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">–û—Ç–º–µ–Ω–∞</button>
                        <button type="button" class="btn btn-primary" onclick="saveEditedContractor(${contractor.id})">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
                    </div>
                </div>
            </div>
        </div>
    `;
    
    // –£–¥–∞–ª—è–µ–º —Å—Ç–∞—Ä–æ–µ –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ, –µ—Å–ª–∏ –µ—Å—Ç—å
    const oldModal = document.getElementById('editContractorModal');
    if (oldModal) {
        oldModal.remove();
    }
    
    // –î–æ–±–∞–≤–ª—è–µ–º –Ω–æ–≤–æ–µ –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ
    document.body.insertAdjacentHTML('beforeend', editModalHtml);
    
    // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ
    const modal = new bootstrap.Modal(document.getElementById('editContractorModal'));
    modal.show();
}

// –§—É–Ω–∫—Ü–∏—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –æ—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—è
async function saveEditedContractor(contractorId) {
    try {
        const contractorData = {
            first_name: document.getElementById('editFirstName').value,
            last_name: document.getElementById('editLastName').value,
            email: document.getElementById('editEmail').value,
            username: document.getElementById('editUsername').value,
            is_active: document.getElementById('editIsActive').checked
        };
        
        const response = await fetch(`/admin/api/contractors/${contractorId}`, {
            method: 'PUT',
            headers: {
                'Content-Type': 'application/json'
            },
            credentials: 'include',
            body: JSON.stringify(contractorData)
        });
        
        const data = await response.json();
        
        if (data.success) {
            alert('–ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å —É—Å–ø–µ—à–Ω–æ –æ–±–Ω–æ–≤–ª–µ–Ω!');
            
            // –ó–∞–∫—Ä—ã–≤–∞–µ–º –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ
            const modal = bootstrap.Modal.getInstance(document.getElementById('editContractorModal'));
            modal.hide();
            
            // –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞–µ–º —Å–ø–∏—Å–æ–∫ –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª–µ–π
            loadContractors();
        } else {
            alert('–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—è: ' + data.message);
        }
    } catch (error) {
        console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—è:', error);
        alert('–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—è');
    }
}

// –§—É–Ω–∫—Ü–∏—è –ø–æ–∫–∞–∑–∞ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ —Å–º–µ–Ω—ã –ø–∞—Ä–æ–ª—è
function showChangePasswordModal(contractorId) {
    const passwordModalHtml = `
        <div class="modal fade" id="changePasswordModal" tabindex="-1">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title">–ò–∑–º–µ–Ω–∏—Ç—å –ø–∞—Ä–æ–ª—å –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—è</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                    </div>
                    <div class="modal-body">
                        <form id="changePasswordForm">
                            <div class="mb-3">
                                <label class="form-label">–ù–æ–≤—ã–π –ø–∞—Ä–æ–ª—å *</label>
                                <input type="password" class="form-control" id="newPassword" required>
                                <small class="text-muted">–í–≤–µ–¥–∏—Ç–µ –Ω–æ–≤—ã–π –ø–∞—Ä–æ–ª—å –¥–ª—è –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—è</small>
                            </div>
                            <div class="mb-3">
                                <label class="form-label">–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ –Ω–æ–≤—ã–π –ø–∞—Ä–æ–ª—å *</label>
                                <input type="password" class="form-control" id="confirmPassword" required>
                            </div>
                        </form>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">–û—Ç–º–µ–Ω–∞</button>
                        <button type="button" class="btn btn-primary" onclick="changeContractorPassword(${contractorId})">
                            –ò–∑–º–µ–Ω–∏—Ç—å –ø–∞—Ä–æ–ª—å
                        </button>
                    </div>
                </div>
            </div>
        </div>
    `;
    
    // –£–¥–∞–ª—è–µ–º —Å—Ç–∞—Ä–æ–µ –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ, –µ—Å–ª–∏ –µ—Å—Ç—å
    const oldModal = document.getElementById('changePasswordModal');
    if (oldModal) {
        oldModal.remove();
    }
    
    // –î–æ–±–∞–≤–ª—è–µ–º –Ω–æ–≤–æ–µ –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ
    document.body.insertAdjacentHTML('beforeend', passwordModalHtml);
    
    // –ó–∞–∫—Ä—ã–≤–∞–µ–º –æ–∫–Ω–æ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è, –µ—Å–ª–∏ –æ–Ω–æ –æ—Ç–∫—Ä—ã—Ç–æ
    const editModal = document.getElementById('editContractorModal');
    if (editModal) {
        const editModalInstance = bootstrap.Modal.getInstance(editModal);
        if (editModalInstance) {
            editModalInstance.hide();
        }
    }
    
    // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Å–º–µ–Ω—ã –ø–∞—Ä–æ–ª—è
    const modal = new bootstrap.Modal(document.getElementById('changePasswordModal'));
    modal.show();
}

// –§—É–Ω–∫—Ü–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏—è –ø–∞—Ä–æ–ª—è –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—è
async function changeContractorPassword(contractorId) {
    const newPassword = document.getElementById('newPassword').value;
    const confirmPassword = document.getElementById('confirmPassword').value;
    
    if (!newPassword || !confirmPassword) {
        alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –∑–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è');
        return;
    }
    
    if (newPassword !== confirmPassword) {
        alert('–ü–∞—Ä–æ–ª–∏ –Ω–µ —Å–æ–≤–ø–∞–¥–∞—é—Ç');
        return;
    }
    
    if (newPassword.length < 6) {
        alert('–ü–∞—Ä–æ–ª—å –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å –º–∏–Ω–∏–º—É–º 6 —Å–∏–º–≤–æ–ª–æ–≤');
        return;
    }
    
    try {
        const response = await fetch(`/admin/api/contractors/${contractorId}/change-password`, {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            credentials: 'include',
            body: JSON.stringify({
                new_password: newPassword
            })
        });
        
        const data = await response.json();
        
        if (data.success) {
            alert('–ü–∞—Ä–æ–ª—å —É—Å–ø–µ—à–Ω–æ –∏–∑–º–µ–Ω–µ–Ω!');
            
            // –ó–∞–∫—Ä—ã–≤–∞–µ–º –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ
            const modal = bootstrap.Modal.getInstance(document.getElementById('changePasswordModal'));
            modal.hide();
            
            // –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞–µ–º —Å–ø–∏—Å–æ–∫ –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª–µ–π
            loadContractors();
        } else {
            alert('–û—à–∏–±–∫–∞ –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –ø–∞—Ä–æ–ª—è: ' + data.message);
        }
    } catch (error) {
        console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –ø–∞—Ä–æ–ª—è:', error);
        alert('–û—à–∏–±–∫–∞ –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –ø–∞—Ä–æ–ª—è');
    }
}

// –§—É–Ω–∫—Ü–∏—è —É–¥–∞–ª–µ–Ω–∏—è –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—è
async function deleteContractor(contractorId) {
    if (!confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å —ç—Ç–æ–≥–æ –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—è? –≠—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ –Ω–µ–ª—å–∑—è –æ—Ç–º–µ–Ω–∏—Ç—å.')) {
        return;
    }
    
    try {
        console.log('–£–¥–∞–ª–µ–Ω–∏–µ –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—è:', contractorId);
        
        const response = await fetch(`/admin/api/contractors/${contractorId}`, {
            method: 'DELETE',
            credentials: 'include'
        });
        
        const data = await response.json();
        
        if (data.success) {
            alert('–ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å —É—Å–ø–µ—à–Ω–æ —É–¥–∞–ª–µ–Ω!');
            loadContractors(); // –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞–µ–º —Å–ø–∏—Å–æ–∫
        } else {
            alert('–û—à–∏–±–∫–∞ –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—è: ' + data.message);
        }
    } catch (error) {
        console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—è:', error);
        alert('–û—à–∏–±–∫–∞ –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—è');
    }
}

console.log('–í—Å–µ —Ñ—É–Ω–∫—Ü–∏–∏ –∫–Ω–æ–ø–æ–∫ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω—ã —É—Å–ø–µ—à–Ω–æ');

console.log('–û–ø—Ä–µ–¥–µ–ª—è–µ–º —Ñ—É–Ω–∫—Ü–∏—é handleSaveContractor...');
// –ì–õ–ê–í–ù–ê–Ø –§–£–ù–ö–¶–ò–Ø - –°–û–•–†–ê–ù–ï–ù–ò–ï –ò–°–ü–û–õ–ù–ò–¢–ï–õ–Ø - –û–ü–†–ï–î–ï–õ–Ø–ï–ú –í HEAD
function handleSaveContractor() {
    console.log('–§—É–Ω–∫—Ü–∏—è handleSaveContractor –≤—ã–∑–≤–∞–Ω–∞');
    
    try {
        console.log('–ù–ê–ß–ê–õ–û handleSaveContractor try –±–ª–æ–∫–∞');
        // –ü—Ä–æ–≤–µ—Ä—è–µ–º –≤—Å–µ –ø–æ–ª—è —Ñ–æ—Ä–º—ã
        const usernameEl = document.getElementById('contractorUsername');
        const emailEl = document.getElementById('contractorEmail');
        const adminPasswordEl = document.getElementById('contractorAdminPassword');
        
        console.log('–≠–ª–µ–º–µ–Ω—Ç—ã –Ω–∞–π–¥–µ–Ω—ã:', {
            usernameEl: !!usernameEl,
            emailEl: !!emailEl,
            adminPasswordEl: !!adminPasswordEl
        });
        
        if (!usernameEl || !emailEl || !adminPasswordEl) {
            console.error('–ù–µ –≤—Å–µ —ç–ª–µ–º–µ–Ω—Ç—ã —Ñ–æ—Ä–º—ã –Ω–∞–π–¥–µ–Ω—ã');
            alert('–û—à–∏–±–∫–∞: —ç–ª–µ–º–µ–Ω—Ç—ã —Ñ–æ—Ä–º—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã');
            return;
        }
        
        const username = usernameEl.value;
        const email = emailEl.value;
        const adminPassword = adminPasswordEl.value;
        
        console.log('–ü–æ–ª—è —Ñ–æ—Ä–º—ã:', { username, email, adminPassword });
        
        if (!username || !email || !adminPassword) {
            alert('–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è: Username, Email –∏ –ü–∞—Ä–æ–ª—å –¥–ª—è –∞–¥–º–∏–Ω–∫–∏');
            return;
        }
        
        const contractorData = {
            username: username,
            email: email,
            first_name: document.getElementById('contractorFirstName').value,
            last_name: document.getElementById('contractorLastName').value,
            role: 'executor',
            is_active: true,
            admin_login: document.getElementById('contractorAdminLogin').value || username,
            admin_password: adminPassword,
            force_password_change: document.getElementById('contractorForcePasswordChange').checked
        };
        
        console.log('–î–∞–Ω–Ω—ã–µ –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—è:', contractorData);
        
        // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –∑–∞–ø—Ä–æ—Å
        fetch('/admin/api/contractors/', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
                'Authorization': 'Basic ' + btoa('admin:qwerty123')
            },
            body: JSON.stringify(contractorData)
        })
        .then(response => {
            console.log('–û—Ç–≤–µ—Ç —Å–µ—Ä–≤–µ—Ä–∞:', response);
            return response.json();
        })
        .then(data => {
            console.log('–î–∞–Ω–Ω—ã–µ –æ—Ç–≤–µ—Ç–∞:', data);
            
            if (data.success) {
                alert('–ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å —É—Å–ø–µ—à–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω!');
                const modal = bootstrap.Modal.getInstance(document.getElementById('addContractorModal'));
                if (modal) modal.hide();
                
                // –û—á–∏—â–∞–µ–º —Ñ–æ—Ä–º—É
                document.getElementById('addContractorForm').reset();
                
                // –û–±–Ω–æ–≤–ª—è–µ–º —Å–ø–∏—Å–æ–∫ –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª–µ–π
                console.log('–ü—ã—Ç–∞–µ–º—Å—è –æ–±–Ω–æ–≤–∏—Ç—å —Å–ø–∏—Å–æ–∫ –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª–µ–π...');
                setTimeout(() => {
                    loadContractors();
                }, 500);
            } else {
                alert('–û—à–∏–±–∫–∞ –ø—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—è: ' + data.message);
            }
        })
        .catch(error => {
            console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—è:', error);
            alert('–û—à–∏–±–∫–∞ –ø—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—è: ' + error.message);
        });
    } catch (error) {
        console.error('–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞:', error);
        alert('–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞: ' + error.message);
    }
}
console.log('–§—É–Ω–∫—Ü–∏—è handleSaveContractor –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∞ —É—Å–ø–µ—à–Ω–æ');

console.log('=== –í–°–ï –§–£–ù–ö–¶–ò–ò –í EXTRA_CSS –û–ü–†–ï–î–ï–õ–ï–ù–´ ===');

// –ü–†–û–°–¢–û–ô –°–ü–û–°–û–ë –ó–ê–ì–†–£–ó–ö–ò –ò–°–ü–û–õ–ù–ò–¢–ï–õ–ï–ô
console.log('–ü–†–û–°–¢–ê–Ø –ó–ê–ì–†–£–ó–ö–ê –ò–°–ü–û–õ–ù–ò–¢–ï–õ–ï–ô...');
setTimeout(function() {
    console.log('–ë–´–°–¢–†–ê–Ø –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø –ß–ï–†–ï–ó 100ms');
    if (typeof loadContractors === 'function') {
        console.log('–í–´–ó–´–í–ê–ï–ú loadContractors(1)');
        loadContractors(1);
    } else {
        console.error('loadContractors –ù–ï –Ø–í–õ–Ø–ï–¢–°–Ø –§–£–ù–ö–¶–ò–ï–ô');
    }
}, 100);

// –î–û–ë–ê–í–õ–Ø–ï–ú –û–ë–†–ê–ë–û–¢–ß–ò–ö–ò –ö–ù–û–ü–û–ö
setTimeout(function() {
    console.log('–ë–´–°–¢–†–ê–Ø –ü–†–ò–í–Ø–ó–ö–ê –û–ë–†–ê–ë–û–¢–ß–ò–ö–û–í –ö–ù–û–ü–û–ö...');
    
    const addBtn = document.getElementById('addContractorBtn');
    const reloadBtn = document.getElementById('reloadBtn');
    const saveBtn = document.getElementById('saveContractorBtn');
    const saveEditBtn = document.getElementById('saveEditContractorBtn');
    
    console.log('–ö–Ω–æ–ø–∫–∏ –Ω–∞–π–¥–µ–Ω—ã:', {
        addBtn: !!addBtn,
        reloadBtn: !!reloadBtn,
        saveBtn: !!saveBtn,
        saveEditBtn: !!saveEditBtn
    });
    
    if (addBtn) {
        addBtn.onclick = function() {
            console.log('–ö–Ω–æ–ø–∫–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –Ω–∞–∂–∞—Ç–∞');
            openContractorModal();
        };
    }
    
    if (reloadBtn) {
        reloadBtn.onclick = function() {
            console.log('–ö–Ω–æ–ø–∫–∞ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏ –Ω–∞–∂–∞—Ç–∞');
            loadContractors(1);
        };
    }
    
    if (saveBtn) {
        saveBtn.onclick = function() {
            console.log('–ö–Ω–æ–ø–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –Ω–∞–∂–∞—Ç–∞');
            handleSaveContractor();
        };
    }
    
    if (saveEditBtn) {
        saveEditBtn.onclick = function() {
            console.log('–ö–Ω–æ–ø–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π –Ω–∞–∂–∞—Ç–∞');
            saveEditContractor();
        };
    }
    
    console.log('–û–ë–†–ê–ë–û–¢–ß–ò–ö–ò –ö–ù–û–ü–û–ö –ü–†–ò–í–Ø–ó–ê–ù–´');
}, 50);

</script>
{% endblock %}

{% block header_actions %}
<div class="d-flex gap-2">
    <button class="btn btn-primary" id="addContractorBtn">
        <i class="fas fa-plus me-1"></i> –î–æ–±–∞–≤–∏—Ç—å –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—è
    </button>
    <button class="btn btn-outline-success" id="exportBtn">
        <i class="fas fa-download me-1"></i> –≠–∫—Å–ø–æ—Ä—Ç
    </button>
    <button class="btn btn-outline-info" id="statsBtn">
        <i class="fas fa-chart-bar me-1"></i> –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
    </button>
    <button class="btn btn-outline-warning" id="reloadBtn" title="–û—Ç–ª–∞–¥–∫–∞: —Ä—É—á–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞">
        <i class="fas fa-refresh me-1"></i> –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—å
    </button>
</div>
{% endblock %}

{% block content %}
<!-- –§–∏–ª—å—Ç—Ä—ã -->
<div class="filter-section">
    <div class="row">
        <div class="col-md-3">
            <label class="form-label">–ü–æ–∏—Å–∫</label>
            <input type="text" class="form-control" id="searchFilter" placeholder="–ò–º—è, email, —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è...">
        </div>
        <div class="col-md-3">
            <label class="form-label">–°–ø–µ—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è</label>
            <select class="form-select" id="specializationFilter">
                <option value="">–í—Å–µ —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏</option>
                <option value="developer">–†–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫</option>
                <option value="designer">–î–∏–∑–∞–π–Ω–µ—Ä</option>
                <option value="tester">–¢–µ—Å—Ç–∏—Ä–æ–≤—â–∏–∫</option>
                <option value="manager">–ú–µ–Ω–µ–¥–∂–µ—Ä</option>
                <option value="analyst">–ê–Ω–∞–ª–∏—Ç–∏–∫</option>
            </select>
        </div>
        <div class="col-md-3">
            <label class="form-label">–°—Ç–∞—Ç—É—Å</label>
            <select class="form-select" id="statusFilter">
                <option value="">–í—Å–µ —Å—Ç–∞—Ç—É—Å—ã</option>
                <option value="active">–ê–∫—Ç–∏–≤–Ω—ã–µ</option>
                <option value="inactive">–ù–µ–∞–∫—Ç–∏–≤–Ω—ã–µ</option>
            </select>
        </div>
        <div class="col-md-3">
            <label class="form-label">–î–µ–π—Å—Ç–≤–∏—è</label>
            <div>
                <button class="btn btn-outline-primary" onclick="applyFilters()">
                    <i class="fas fa-filter me-1"></i> –ü—Ä–∏–º–µ–Ω–∏—Ç—å
                </button>
                <button class="btn btn-outline-secondary" onclick="clearFilters()">
                    <i class="fas fa-times me-1"></i> –û—á–∏—Å—Ç–∏—Ç—å
                </button>
            </div>
        </div>
    </div>
</div>

<!-- –°–ø–∏—Å–æ–∫ –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª–µ–π -->
<div id="contractorsList" class="row">
    <!-- –ö–æ–Ω—Ç–µ–Ω—Ç –±—É–¥–µ—Ç –∑–∞–≥—Ä—É–∂–µ–Ω —á–µ—Ä–µ–∑ JavaScript -->
</div>

<!-- –ü–∞–≥–∏–Ω–∞—Ü–∏—è -->
<nav aria-label="–ù–∞–≤–∏–≥–∞—Ü–∏—è –ø–æ —Å—Ç—Ä–∞–Ω–∏—Ü–∞–º">
    <ul class="pagination justify-content-center" id="pagination">
        <!-- –ü–∞–≥–∏–Ω–∞—Ü–∏—è –±—É–¥–µ—Ç –¥–æ–±–∞–≤–ª–µ–Ω–∞ —á–µ—Ä–µ–∑ JavaScript -->
    </ul>
</nav>


<!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–µ—Ç–∞–ª–µ–π –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—è -->
<div class="modal fade" id="contractorDetailsModal" tabindex="-1">
    <div class="modal-dialog modal-xl">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">–î–µ—Ç–∞–ª–∏ –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—è</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body" id="contractorDetailsContent">
                <!-- –ö–æ–Ω—Ç–µ–Ω—Ç –±—É–¥–µ—Ç –∑–∞–≥—Ä—É–∂–µ–Ω —á–µ—Ä–µ–∑ JavaScript -->
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">–ó–∞–∫—Ä—ã—Ç—å</button>
                <button type="button" class="btn btn-primary" onclick="editContractor()">–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å</button>
            </div>
        </div>
    </div>
</div>

<!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Å–æ–∑–¥–∞–Ω–∏—è –≤—ã–ø–ª–∞—Ç—ã -->
<div class="modal fade" id="createPaymentModal" tabindex="-1">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">–°–æ–∑–¥–∞—Ç—å –≤—ã–ø–ª–∞—Ç—É</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <form id="createPaymentForm">
                    <input type="hidden" id="paymentContractorId">
                    <div class="row">
                        <div class="col-md-6 mb-3">
                            <label class="form-label">–°—É–º–º–∞ (‚ÇΩ) *</label>
                            <input type="number" class="form-control" id="paymentAmount" min="0" step="0.01" required>
                        </div>
                        <div class="col-md-6 mb-3">
                            <label class="form-label">–¢–∏–ø –≤—ã–ø–ª–∞—Ç—ã</label>
                            <select class="form-select" id="paymentType" required>
                                <option value="hourly">–ü–æ—á–∞—Å–æ–≤–∞—è –æ–ø–ª–∞—Ç–∞</option>
                                <option value="fixed">–§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Å—É–º–º–∞</option>
                                <option value="bonus">–ë–æ–Ω—É—Å</option>
                                <option value="penalty">–®—Ç—Ä–∞—Ñ</option>
                            </select>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-6 mb-3">
                            <label class="form-label">–î–∞—Ç–∞ –≤—ã–ø–ª–∞—Ç—ã *</label>
                            <input type="date" class="form-control" id="paymentDate" required>
                        </div>
                        <div class="col-md-6 mb-3">
                            <label class="form-label">–°—Ä–æ–∫ –≤—ã–ø–ª–∞—Ç—ã</label>
                            <input type="date" class="form-control" id="paymentDueDate">
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-6 mb-3">
                            <label class="form-label">–°–ø–æ—Å–æ–± –æ–ø–ª–∞—Ç—ã</label>
                            <select class="form-select" id="paymentMethod">
                                <option value="bank_transfer">–ë–∞–Ω–∫–æ–≤—Å–∫–∏–π –ø–µ—Ä–µ–≤–æ–¥</option>
                                <option value="cash">–ù–∞–ª–∏—á–Ω—ã–µ</option>
                                <option value="card">–ö–∞—Ä—Ç–∞</option>
                                <option value="crypto">–ö—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç–∞</option>
                            </select>
                        </div>
                        <div class="col-md-6 mb-3">
                            <label class="form-label">–ù–∞–ª–æ–≥–æ–≤–∞—è —Å—Ç–∞–≤–∫–∞ (%)</label>
                            <input type="number" class="form-control" id="paymentTaxRate" min="0" max="100" step="0.1" value="13">
                        </div>
                    </div>
                    <div class="mb-3">
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" id="withholdTax">
                            <label class="form-check-label" for="withholdTax">
                                –£–¥–µ—Ä–∂–∞—Ç—å –Ω–∞–ª–æ–≥
                            </label>
                        </div>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">–û–ø–∏—Å–∞–Ω–∏–µ –≤—ã–ø–ª–∞—Ç—ã *</label>
                        <textarea class="form-control" id="paymentDescription" rows="3" required></textarea>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">–û—Ç–º–µ–Ω–∞</button>
                <button type="button" class="btn btn-primary" onclick="savePayment()">–°–æ–∑–¥–∞—Ç—å –≤—ã–ø–ª–∞—Ç—É</button>
            </div>
        </div>
    </div>
</div>

<!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ -->
<div class="modal fade" id="statsModal" tabindex="-1">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—è–º</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body" id="statsContent">
                <!-- –ö–æ–Ω—Ç–µ–Ω—Ç –±—É–¥–µ—Ç –∑–∞–≥—Ä—É–∂–µ–Ω —á–µ—Ä–µ–∑ JavaScript -->
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block modals %}
<!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—è -->
<div class="modal fade" id="addContractorModal" tabindex="-1">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">–î–æ–±–∞–≤–∏—Ç—å –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—è</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <form id="addContractorForm">
                    <div class="row">
                        <div class="col-md-6 mb-3">
                            <label class="form-label">Username *</label>
                            <input type="text" class="form-control" id="contractorUsername" required>
                        </div>
                        <div class="col-md-6 mb-3">
                            <label class="form-label">Email *</label>
                            <input type="email" class="form-control" id="contractorEmail" required>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-6 mb-3">
                            <label class="form-label">–ò–º—è</label>
                            <input type="text" class="form-control" id="contractorFirstName">
                        </div>
                        <div class="col-md-6 mb-3">
                            <label class="form-label">–§–∞–º–∏–ª–∏—è</label>
                            <input type="text" class="form-control" id="contractorLastName">
                        </div>
                    </div>
                    
                    <hr class="my-4">
                    <h6 class="mb-3">–î–æ—Å—Ç—É–ø –∫ –∞–¥–º–∏–Ω–∫–µ</h6>
                    
                    <div class="row">
                        <div class="col-md-6 mb-3">
                            <label class="form-label">–õ–æ–≥–∏–Ω –¥–ª—è –∞–¥–º–∏–Ω–∫–∏</label>
                            <input type="text" class="form-control" id="contractorAdminLogin" placeholder="–ë—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω username –µ—Å–ª–∏ –Ω–µ —É–∫–∞–∑–∞–Ω">
                        </div>
                        <div class="col-md-6 mb-3">
                            <label class="form-label">–ü–∞—Ä–æ–ª—å –¥–ª—è –∞–¥–º–∏–Ω–∫–∏ *</label>
                            <input type="password" class="form-control" id="contractorAdminPassword" required>
                        </div>
                    </div>
                    
                    <div class="mb-3">
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" id="contractorForcePasswordChange">
                            <label class="form-check-label" for="contractorForcePasswordChange">
                                –ü–æ—Ç—Ä–µ–±–æ–≤–∞—Ç—å —Å–º–µ–Ω—É –ø–∞—Ä–æ–ª—è –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –≤—Ö–æ–¥–µ
                            </label>
                        </div>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">–û—Ç–º–µ–Ω–∞</button>
                <button type="button" class="btn btn-primary" id="saveContractorBtn">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
            </div>
        </div>
    </div>
</div>

<!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—è -->
<div class="modal fade" id="editContractorModal" tabindex="-1">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—è</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <form id="editContractorForm">
                    <input type="hidden" id="editContractorId">
                    <div class="row">
                        <div class="col-md-6 mb-3">
                            <label class="form-label">Username *</label>
                            <input type="text" class="form-control" id="editContractorUsername" required>
                        </div>
                        <div class="col-md-6 mb-3">
                            <label class="form-label">Email *</label>
                            <input type="email" class="form-control" id="editContractorEmail" required>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-6 mb-3">
                            <label class="form-label">–ò–º—è</label>
                            <input type="text" class="form-control" id="editContractorFirstName">
                        </div>
                        <div class="col-md-6 mb-3">
                            <label class="form-label">–§–∞–º–∏–ª–∏—è</label>
                            <input type="text" class="form-control" id="editContractorLastName">
                        </div>
                    </div>
                    <div class="mb-3">
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" id="editContractorIsActive">
                            <label class="form-check-label" for="editContractorIsActive">
                                –ê–∫—Ç–∏–≤–µ–Ω
                            </label>
                        </div>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">–û—Ç–º–µ–Ω–∞</button>
                <button type="button" class="btn btn-primary" id="saveEditContractorBtn">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è</button>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
console.log('=== –ù–ê–ß–ê–õ–û –°–ï–ö–¶–ò–ò EXTRA_JS ===');
// –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ —É–∂–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω—ã –≤ —Å–µ–∫—Ü–∏–∏ extra_css

// –ì–õ–ê–í–ù–ê–Ø –§–£–ù–ö–¶–ò–Ø - –°–û–•–†–ê–ù–ï–ù–ò–ï –ò–°–ü–û–õ–ù–ò–¢–ï–õ–Ø - –ì–õ–û–ë–ê–õ–¨–ù–ê–Ø
function saveContractor() {
    console.log('–§—É–Ω–∫—Ü–∏—è saveContractor –≤—ã–∑–≤–∞–Ω–∞');
    
    // –ü—Ä–æ–≤–µ—Ä—è–µ–º –≤—Å–µ –ø–æ–ª—è —Ñ–æ—Ä–º—ã
    const usernameEl = document.getElementById('contractorUsername');
    const emailEl = document.getElementById('contractorEmail'); 
    const adminPasswordEl = document.getElementById('contractorAdminPassword');
    
    if (!usernameEl || !emailEl || !adminPasswordEl) {
        console.error('–≠–ª–µ–º–µ–Ω—Ç—ã —Ñ–æ—Ä–º—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã');
        showNotification('–û—à–∏–±–∫–∞: —Ñ–æ—Ä–º–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞', 'danger');
        return;
    }
    
    const username = usernameEl.value;
    const email = emailEl.value;
    const adminPassword = adminPasswordEl.value;
    
    if (!username || !email || !adminPassword) {
        showNotification('–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è: Username, Email –∏ –ü–∞—Ä–æ–ª—å –¥–ª—è –∞–¥–º–∏–Ω–∫–∏', 'warning');
        return;
    }
    
    const contractorData = {
        username: username,
        email: email,
        first_name: document.getElementById('contractorFirstName').value,
        last_name: document.getElementById('contractorLastName').value,
        role: 'executor',
        is_active: true,
        admin_login: document.getElementById('contractorAdminLogin').value || username,
        admin_password: adminPassword,
        force_password_change: document.getElementById('contractorForcePasswordChange').checked
    };
    
    console.log('–î–∞–Ω–Ω—ã–µ –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—è:', contractorData);
    
    // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –∑–∞–ø—Ä–æ—Å
    fetch('/admin/api/contractors/', {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json',
            'Authorization': 'Basic ' + btoa('admin:qwerty123')
        },
        body: JSON.stringify(contractorData)
    })
    .then(response => response.json())
    .then(data => {
        console.log('–î–∞–Ω–Ω—ã–µ –æ—Ç–≤–µ—Ç–∞:', data);
        
        if (data.success) {
            showNotification('–ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å —É—Å–ø–µ—à–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω!', 'success');
            const modal = bootstrap.Modal.getInstance(document.getElementById('addContractorModal'));
            modal.hide();
            
            // –û—á–∏—â–∞–µ–º —Ñ–æ—Ä–º—É
            document.getElementById('addContractorForm').reset();
            
            console.log('–ü—ã—Ç–∞–µ–º—Å—è –æ–±–Ω–æ–≤–∏—Ç—å —Å–ø–∏—Å–æ–∫ –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª–µ–π –ø–æ—Å–ª–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è (–≤—Ç–æ—Ä–æ–µ –º–µ—Å—Ç–æ)...');
            setTimeout(() => {
                loadContractors(currentPage);
            }, 500);
        } else {
            showNotification('–û—à–∏–±–∫–∞ –ø—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—è: ' + data.message, 'danger');
        }
    })
    .catch(error => {
        console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—è:', error);
        showNotification('–û—à–∏–±–∫–∞ –ø—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—è: ' + error.message, 'danger');
    });
}

// –ì–õ–û–ë–ê–õ–¨–ù–´–ï –§–£–ù–ö–¶–ò–ò - –û–ü–†–ï–î–ï–õ–Ø–ï–ú –°–†–ê–ó–£
window.openModal = function() {
    console.log('–§—É–Ω–∫—Ü–∏—è openModal –≤—ã–∑–≤–∞–Ω–∞');
    const modalElement = document.getElementById('addContractorModal');
    console.log('–ù–∞–π–¥–µ–Ω–æ –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ:', modalElement);
    
    if (modalElement) {
        if (typeof bootstrap !== 'undefined') {
            console.log('Bootstrap –¥–æ—Å—Ç—É–ø–µ–Ω, —Å–æ–∑–¥–∞–µ–º –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ');
            const modal = new bootstrap.Modal(modalElement);
            modal.show();
        } else {
            console.error('Bootstrap –Ω–µ –Ω–∞–π–¥–µ–Ω');
        }
    } else {
        console.error('–ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ');
    }
}

window.openAddContractorModal = function() {
    const modal = new bootstrap.Modal(document.getElementById('addContractorModal'));
    modal.show();
}

// –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ —Å–æ–±—ã—Ç–∏—è –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è –ø—Ä–∏ –ø–µ—Ä–µ—Ö–æ–¥–µ
window.addEventListener('beforeunload', function() {
    // –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ç–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ —Ñ–∏–ª—å—Ç—Ä–æ–≤
    const state = {
        search: document.getElementById('searchFilter')?.value || '',
        specialization: document.getElementById('specializationFilter')?.value || '',
        status: document.getElementById('statusFilter')?.value || '',
        page: currentPage
    };
    sessionStorage.setItem('contractorsState', JSON.stringify(state));
});

// –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
window.addEventListener('pageshow', function() {
    const savedState = sessionStorage.getItem('contractorsState');
    if (savedState) {
        try {
            const state = JSON.parse(savedState);
            // –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ñ–∏–ª—å—Ç—Ä—ã
            if (document.getElementById('searchFilter')) document.getElementById('searchFilter').value = state.search;
            if (document.getElementById('specializationFilter')) document.getElementById('specializationFilter').value = state.specialization;
            if (document.getElementById('statusFilter')) document.getElementById('statusFilter').value = state.status;
            currentPage = state.page || 1;
        } catch (e) {
            console.log('–û—à–∏–±–∫–∞ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è:', e);
        }
    }
});

document.addEventListener('DOMContentLoaded', function() {
    console.log('=== DOM –ó–ê–ì–†–£–ñ–ï–ù - CONTRACTORS PAGE ===');
    console.log('URL —Å—Ç—Ä–∞–Ω–∏—Ü—ã:', window.location.href);
    console.log('currentPage –Ω–∞ —Å—Ç–∞—Ä—Ç–µ:', typeof currentPage !== 'undefined' ? currentPage : '–ù–ï –û–ü–†–ï–î–ï–õ–ï–ù');
    console.log('itemsPerPage –Ω–∞ —Å—Ç–∞—Ä—Ç–µ:', typeof itemsPerPage !== 'undefined' ? itemsPerPage : '–ù–ï –û–ü–†–ï–î–ï–õ–ï–ù');
    
    // –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ –≤—Å–µ—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤
    const addBtn = document.getElementById('addContractorBtn');
    const modal = document.getElementById('addContractorModal');
    const saveContractorBtn = document.getElementById('saveContractorBtn');
    const contractorsList = document.getElementById('contractorsList');
    
    console.log('–≠–ª–µ–º–µ–Ω—Ç—ã —Å—Ç—Ä–∞–Ω–∏—Ü—ã:');
    console.log('  –ö–Ω–æ–ø–∫–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è:', !!addBtn, addBtn);
    console.log('  –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ:', !!modal, modal);
    console.log('  –ö–Ω–æ–ø–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è:', !!saveContractorBtn, saveContractorBtn);
    console.log('  –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä —Å–ø–∏—Å–∫–∞:', !!contractorsList, contractorsList);
    console.log('  Bootstrap –¥–æ—Å—Ç—É–ø–µ–Ω:', typeof bootstrap);
    
    // –ü—Ä–æ—Å—Ç–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ —Ñ—É–Ω–∫—Ü–∏–∏
    if (typeof window.openModal === 'function') {
        console.log('–§—É–Ω–∫—Ü–∏—è window.openModal –¥–æ—Å—Ç—É–ø–Ω–∞');
    } else {
        console.error('–§—É–Ω–∫—Ü–∏—è window.openModal –Ω–µ –Ω–∞–π–¥–µ–Ω–∞');
    }
    
    // –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ
    const savedState = sessionStorage.getItem('contractorsState');
    if (savedState) {
        try {
            const state = JSON.parse(savedState);
            if (document.getElementById('searchFilter')) document.getElementById('searchFilter').value = state.search;
            if (document.getElementById('specializationFilter')) document.getElementById('specializationFilter').value = state.specialization;
            if (document.getElementById('statusFilter')) document.getElementById('statusFilter').value = state.status;
            currentPage = state.page || 1;
        } catch (e) {
            console.log('–û—à–∏–±–∫–∞ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è:', e);
        }
    }
    
    console.log('–ü–û–î–ì–û–¢–û–í–ö–ê –ö –ó–ê–ì–†–£–ó–ö–ï –ò–°–ü–û–õ–ù–ò–¢–ï–õ–ï–ô:');
    console.log('  currentPage:', typeof currentPage !== 'undefined' ? currentPage : '–ù–ï –û–ü–†–ï–î–ï–õ–ï–ù - –ò–°–ü–û–õ–¨–ó–£–ï–ú 1');
    console.log('  –§—É–Ω–∫—Ü–∏—è loadContractors –¥–æ—Å—Ç—É–ø–Ω–∞:', typeof loadContractors === 'function');
    
    const pageToLoad = typeof currentPage !== 'undefined' ? currentPage : 1;
    console.log('  –ó–∞–≥—Ä—É–∂–∞–µ–º —Å—Ç—Ä–∞–Ω–∏—Ü—É:', pageToLoad);
    
    try {
        console.log('–í–´–ó–´–í–ê–ï–ú loadContractors(' + pageToLoad + ')...');
        loadContractors(pageToLoad);
        console.log('loadContractors –≤—ã–∑–≤–∞–Ω —É—Å–ø–µ—à–Ω–æ');
    } catch (error) {
        console.error('–û–®–ò–ë–ö–ê –ø—Ä–∏ –≤—ã–∑–æ–≤–µ loadContractors:', error);
        console.error('Stack:', error.stack);
    }
    
    // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π –¥–ª—è —Ñ–∏–ª—å—Ç—Ä–æ–≤
    document.getElementById('searchFilter').addEventListener('input', applyFilters);
    document.getElementById('specializationFilter').addEventListener('change', applyFilters);
    document.getElementById('statusFilter').addEventListener('change', applyFilters);
    
    // –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —á–µ—Ä–µ–∑ setTimeout
    setTimeout(function() {
        const addBtn = document.getElementById('addContractorBtn');
        const modal = document.getElementById('addContractorModal');
        
        console.log('–ü–æ–≤—Ç–æ—Ä–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —á–µ—Ä–µ–∑ setTimeout:');
        console.log('–ö–Ω–æ–ø–∫–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è (setTimeout):', addBtn);
        console.log('–ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ (setTimeout):', modal);
        
        if (addBtn && modal) {
            console.log('–ü—Ä–∏–≤—è–∑—ã–≤–∞–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –Ω–∞–ø—Ä—è–º—É—é');
            addBtn.onclick = function(e) {
                console.log('–ö–Ω–æ–ø–∫–∞ –Ω–∞–∂–∞—Ç–∞ (onclick)');
                e.preventDefault();
                const modalInstance = new bootstrap.Modal(modal);
                modalInstance.show();
            };
        }
    }, 1000);
    
    // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è –∫–Ω–æ–ø–∫–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—è —á–µ—Ä–µ–∑ –¥–µ–ª–µ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
    document.addEventListener('click', function(event) {
        if (event.target.id === 'addContractorBtn' || event.target.closest('#addContractorBtn')) {
            console.log('–ö–Ω–æ–ø–∫–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—è –Ω–∞–∂–∞—Ç–∞ (–¥–µ–ª–µ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ)');
            event.preventDefault();
            const modalElement = document.getElementById('addContractorModal');
            if (modalElement) {
                console.log('–ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –Ω–∞–π–¥–µ–Ω–æ');
                const modal = new bootstrap.Modal(modalElement);
                modal.show();
            } else {
                console.error('–ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ addContractorModal –Ω–µ –Ω–∞–π–¥–µ–Ω–æ');
            }
        }
    });
    
    // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è –∫–Ω–æ–ø–∫–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—è - —É–∂–µ –µ—Å—Ç—å onclick –≤ HTML
});

// –ê–õ–¨–¢–ï–†–ù–ê–¢–ò–í–ù–´–ô –°–ü–û–°–û–ë –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–ò
window.addEventListener('load', function() {
    console.log('=== WINDOW LOAD EVENT - CONTRACTORS ===');
    console.log('–ü—Ä–æ–≤–µ—Ä—è–µ–º, –∑–∞–≥—Ä—É–∂–µ–Ω—ã –ª–∏ –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª–∏...');
    
    const contractorsList = document.getElementById('contractorsList');
    if (contractorsList && contractorsList.innerHTML.trim() === '') {
        console.log('–°–ø–∏—Å–æ–∫ –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª–µ–π –ø—É—Å—Ç, –∑–∞–≥—Ä—É–∂–∞–µ–º...');
        setTimeout(() => {
            loadContractors(1);
        }, 500);
    } else {
        console.log('–°–ø–∏—Å–æ–∫ –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª–µ–π —É–∂–µ –∑–∞–ø–æ–ª–Ω–µ–Ω –∏–ª–∏ —ç–ª–µ–º–µ–Ω—Ç –Ω–µ –Ω–∞–π–¥–µ–Ω');
    }
});

// –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø –°–†–ê–ó–£ –ü–û–°–õ–ï –û–ü–†–ï–î–ï–õ–ï–ù–ò–Ø –§–£–ù–ö–¶–ò–ô
console.log('=== –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø –ü–û–°–õ–ï –û–ü–†–ï–î–ï–õ–ï–ù–ò–Ø –§–£–ù–ö–¶–ò–ô ===');
setTimeout(function() {
    console.log('–û—Ç–ª–æ–∂–µ–Ω–Ω–∞—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —á–µ—Ä–µ–∑ 1 —Å–µ–∫—É–Ω–¥—É...');
    const contractorsList = document.getElementById('contractorsList');
    console.log('contractorsList –Ω–∞–π–¥–µ–Ω:', !!contractorsList);
    
    if (contractorsList && contractorsList.innerHTML.trim() === '') {
        console.log('–ó–∞–ø—É—Å–∫–∞–µ–º –∑–∞–≥—Ä—É–∑–∫—É –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª–µ–π...');
        loadContractors(1);
    }
}, 1000);

async function loadContractors(page = 1) {
    console.log('=== –ó–ê–ì–†–£–ó–ö–ê –ò–°–ü–û–õ–ù–ò–¢–ï–õ–ï–ô ===');
    console.log('–°—Ç—Ä–∞–Ω–∏—Ü–∞:', page);
    
    try {
        const searchFilter = document.getElementById('searchFilter');
        const specializationFilter = document.getElementById('specializationFilter');
        const statusFilter = document.getElementById('statusFilter');
        
        console.log('–≠–ª–µ–º–µ–Ω—Ç—ã —Ñ–∏–ª—å—Ç—Ä–æ–≤ –Ω–∞–π–¥–µ–Ω—ã:', {
            searchFilter: !!searchFilter,
            specializationFilter: !!specializationFilter,
            statusFilter: !!statusFilter
        });
        
        // –ò—Å–ø–æ–ª—å–∑—É–µ–º —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –¥–ª—è limit, –µ—Å–ª–∏ itemsPerPage –Ω–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω
        const limit = typeof itemsPerPage !== 'undefined' ? itemsPerPage : 12;
        
        const searchParams = new URLSearchParams({
            page: page,
            limit: limit,
            search: searchFilter ? searchFilter.value : '',
            specialization: specializationFilter ? specializationFilter.value : '',
            status: statusFilter ? statusFilter.value : ''
        });
        
        const url = `/admin/api/contractors/?${searchParams}`;
        console.log('–ó–∞–ø—Ä–æ—Å –∫ URL:', url);
        console.log('Search params:', searchParams.toString());
        
        console.log('–û—Ç–ø—Ä–∞–≤–ª—è–µ–º –∑–∞–ø—Ä–æ—Å...');
        const response = await fetch(url, {
            credentials: 'include'
        });
        
        console.log('Response –ø–æ–ª—É—á–µ–Ω:');
        console.log('Response status:', response.status);
        console.log('Response ok:', response.ok);
        console.log('Response headers:', Object.fromEntries(response.headers.entries()));
        
        if (!response.ok) {
            console.error('HTTP –æ—à–∏–±–∫–∞:', response.status, response.statusText);
            const errorText = await response.text();
            console.error('–¢–µ–∫—Å—Ç –æ—à–∏–±–∫–∏:', errorText);
            showNotification(`–û—à–∏–±–∫–∞ HTTP ${response.status}: ${response.statusText}`, 'danger');
            return;
        }
        
        const data = await response.json();
        console.log('–î–∞–Ω–Ω—ã–µ –æ—Ç–≤–µ—Ç–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é:', JSON.stringify(data, null, 2));
        
        if (data.success) {
            console.log('SUCCESS: –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª–µ–π:', data.data ? data.data.length : 'data.data –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç');
            if (data.data && Array.isArray(data.data)) {
                console.log('–ü–µ—Ä–≤—ã–π –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å:', data.data[0]);
                displayContractors(data.data);
                // –û–±–Ω–æ–≤–ª—è–µ–º –ø–∞–≥–∏–Ω–∞—Ü–∏—é
                updatePagination(page, Math.ceil(data.total / limit), data.total);
            } else {
                console.warn('data.data –Ω–µ —è–≤–ª—è–µ—Ç—Å—è –º–∞—Å—Å–∏–≤–æ–º –∏–ª–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç');
                displayContractors([]);
            }
        } else {
            console.error('API SUCCESS=FALSE, —Å–æ–æ–±—â–µ–Ω–∏–µ:', data.message);
            showNotification('–û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª–µ–π: ' + (data.message || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –æ—à–∏–±–∫–∞'), 'danger');
            displayContractors([]);
        }
    } catch (error) {
        console.error('–ö–†–ò–¢–ò–ß–ï–°–ö–ê–Ø –û–®–ò–ë–ö–ê loadContractors:', error);
        console.error('Stack trace:', error.stack);
        showNotification('–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª–µ–π: ' + error.message, 'danger');
        displayContractors([]);
    }
    console.log('=== –ö–û–ù–ï–¶ loadContractors ===');
}

function generateStars(rating) {
    const fullStars = Math.floor(rating);
    const halfStar = rating % 1 >= 0.5;
    const emptyStars = 5 - fullStars - (halfStar ? 1 : 0);
    
    return '‚òÖ'.repeat(fullStars) + (halfStar ? '‚òÜ' : '') + '‚òÜ'.repeat(emptyStars);
}

function applyFilters() {
    currentPage = 1;
    loadContractors(currentPage);
}

function clearFilters() {
    document.getElementById('searchFilter').value = '';
    document.getElementById('specializationFilter').value = '';
    document.getElementById('statusFilter').value = '';
    applyFilters();
}


</script>
{% endblock %}
