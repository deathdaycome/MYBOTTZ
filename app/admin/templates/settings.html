{% extends "base.html" %}

{% block title %}–ù–∞—Å—Ç—Ä–æ–π–∫–∏ - {{ super() }}{% endblock %}

{% block page_title %}–ù–∞—Å—Ç—Ä–æ–π–∫–∏{% endblock %}

{% block header_actions %}
<div class="d-flex gap-2">
    <button class="btn btn-outline-success btn-custom" onclick="saveAllSettings()">
        <i class="fas fa-save me-1"></i> –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤—Å–µ
    </button>
    <button class="btn btn-outline-warning btn-custom" onclick="resetToDefaults()">
        <i class="fas fa-undo me-1"></i> –°–±—Ä–æ—Å–∏—Ç—å
    </button>
    <button class="btn btn-outline-info btn-custom" onclick="exportSettings()">
        <i class="fas fa-download me-1"></i> –≠–∫—Å–ø–æ—Ä—Ç
    </button>
    <button class="btn btn-outline-secondary btn-custom" onclick="location.reload()">
        <i class="fas fa-sync-alt me-1"></i> –û–±–Ω–æ–≤–∏—Ç—å
    </button>
</div>
{% endblock %}

{% block content %}
<div class="row">
    <!-- –ú–µ–Ω—é —Ä–∞–∑–¥–µ–ª–æ–≤ -->
    <div class="col-md-3 mb-4">
        <div class="card sticky-top" style="top: 20px;">
            <div class="card-header">
                <h5 class="mb-0">
                    <i class="fas fa-list me-2"></i>–†–∞–∑–¥–µ–ª—ã
                </h5>
            </div>
            <div class="card-body p-0">
                <div class="list-group list-group-flush">
                    <a href="#ai-settings" class="list-group-item list-group-item-action settings-nav-link active" data-section="ai">
                        <i class="fas fa-robot me-2"></i>AI –ù–∞—Å—Ç—Ä–æ–π–∫–∏
                    </a>
                    <a href="#bot-settings" class="list-group-item list-group-item-action settings-nav-link" data-section="bot">
                        <i class="fas fa-cog me-2"></i>–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –±–æ—Ç–∞
                    </a>
                    <a href="#pricing-settings" class="list-group-item list-group-item-action settings-nav-link" data-section="pricing">
                        <i class="fas fa-dollar-sign me-2"></i>–¶–µ–Ω–æ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ
                    </a>
                    <a href="#notification-settings" class="list-group-item list-group-item-action settings-nav-link" data-section="notifications">
                        <i class="fas fa-bell me-2"></i>–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
                    </a>
                    <a href="#security-settings" class="list-group-item list-group-item-action settings-nav-link" data-section="security">
                        <i class="fas fa-shield-alt me-2"></i>–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
                    </a>
                    <a href="#appearance-settings" class="list-group-item list-group-item-action settings-nav-link" data-section="appearance">
                        <i class="fas fa-palette me-2"></i>–í–Ω–µ—à–Ω–∏–π –≤–∏–¥
                    </a>
                    <a href="#analytics-settings" class="list-group-item list-group-item-action settings-nav-link" data-section="analytics">
                        <i class="fas fa-chart-bar me-2"></i>–ê–Ω–∞–ª–∏—Ç–∏–∫–∞
                    </a>
                    <a href="#integrations-settings" class="list-group-item list-group-item-action settings-nav-link" data-section="integrations">
                        <i class="fas fa-plug me-2"></i>–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏
                    </a>
                </div>
            </div>
        </div>
    </div>

    <!-- –°–æ–¥–µ—Ä–∂–∏–º–æ–µ –Ω–∞—Å—Ç—Ä–æ–µ–∫ -->
    <div class="col-md-9">
        <!-- AI –ù–∞—Å—Ç—Ä–æ–π–∫–∏ -->
        <div class="settings-section" id="ai-settings">
            <div class="card mb-4">
                <div class="card-header">
                    <h5 class="mb-0">
                        <i class="fas fa-robot me-2"></i>AI –ù–∞—Å—Ç—Ä–æ–π–∫–∏
                    </h5>
                </div>
                <div class="card-body">
                    <div class="row">
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label for="ai-provider" class="form-label">AI –ü—Ä–æ–≤–∞–π–¥–µ—Ä</label>
                                <select class="form-select" id="ai-provider" name="ai_provider">
                                    <option value="openrouter">OpenRouter</option>
                                    <option value="openai">OpenAI</option>
                                </select>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label for="ai-model" class="form-label">–ú–æ–¥–µ–ª—å AI</label>
                                <select class="form-select" id="ai-model" name="ai_model">
                                    <option value="anthropic/claude-3.5-sonnet">Claude 3.5 Sonnet</option>
                                    <option value="openai/gpt-4">GPT-4</option>
                                    <option value="openai/gpt-3.5-turbo">GPT-3.5 Turbo</option>
                                    <option value="meta-llama/llama-3.1-70b-instruct">Llama 3.1 70B</option>
                                </select>
                            </div>
                        </div>
                    </div>
                    
                    <div class="row">
                        <div class="col-md-4">
                            <div class="mb-3">
                                <label for="ai-temperature" class="form-label">Temperature</label>
                                <input type="range" class="form-range" id="ai-temperature" name="ai_temperature" min="0" max="1" step="0.1" value="0.7">
                                <div class="d-flex justify-content-between">
                                    <small>0 (—Ç–æ—á–Ω–æ)</small>
                                    <small id="temperature-value">0.7</small>
                                    <small>1 (–∫—Ä–µ–∞—Ç–∏–≤–Ω–æ)</small>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="mb-3">
                                <label for="ai-max-tokens" class="form-label">–ú–∞–∫—Å. —Ç–æ–∫–µ–Ω—ã</label>
                                <input type="number" class="form-control" id="ai-max-tokens" name="ai_max_tokens" value="1000" min="100" max="4000">
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="mb-3">
                                <label for="ai-timeout" class="form-label">–¢–∞–π–º–∞—É—Ç (—Å–µ–∫)</label>
                                <input type="number" class="form-control" id="ai-timeout" name="ai_timeout" value="30" min="5" max="120">
                            </div>
                        </div>
                    </div>

                    <div class="mb-3">
                        <label for="consultant-prompt" class="form-label">–°–∏—Å—Ç–µ–º–Ω—ã–π –ø—Ä–æ–º–ø—Ç –∫–æ–Ω—Å—É–ª—å—Ç–∞–Ω—Ç–∞</label>
                        <textarea class="form-control" id="consultant-prompt" name="consultant_prompt" rows="5" placeholder="–í–≤–µ–¥–∏—Ç–µ —Å–∏—Å—Ç–µ–º–Ω—ã–π –ø—Ä–æ–º–ø—Ç –¥–ª—è AI –∫–æ–Ω—Å—É–ª—å—Ç–∞–Ω—Ç–∞...">–¢—ã - —ç–∫—Å–ø–µ—Ä—Ç-–∫–æ–Ω—Å—É–ª—å—Ç–∞–Ω—Ç –ø–æ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ Telegram-–±–æ—Ç–æ–≤ –∏ —á–∞—Ç-–±–æ—Ç–æ–≤. –ü–æ–º–æ–≥–∞–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º —Å –≤–æ–ø—Ä–æ—Å–∞–º–∏ –ø–æ –ø—Ä–æ–µ–∫—Ç–∞–º, —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏—è–º, –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ –∏ –ª—É—á—à–∏–º –ø—Ä–∞–∫—Ç–∏–∫–∞–º. –û—Ç–≤–µ—á–∞–π –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–æ, –Ω–æ –¥—Ä—É–∂–µ–ª—é–±–Ω–æ. –î–∞–≤–∞–π –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏.</textarea>
                    </div>

                    <div class="mb-3">
                        <label for="tz-analysis-prompt" class="form-label">–ü—Ä–æ–º–ø—Ç –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –¢–ó</label>
                        <textarea class="form-control" id="tz-analysis-prompt" name="tz_analysis_prompt" rows="4" placeholder="–ü—Ä–æ–º–ø—Ç –¥–ª—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–∏—è –¢–ó...">–ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–π —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –∑–∞–¥–∞–Ω–∏–µ –∏ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä—É–π –µ–≥–æ –≤ —Å–ª–µ–¥—É—é—â–µ–º —Ñ–æ—Ä–º–∞—Ç–µ: —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª, —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è, —Å—Ä–æ–∫–∏, –±—é–¥–∂–µ—Ç, –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø–æ–∂–µ–ª–∞–Ω–∏—è.</textarea>
                    </div>
                </div>
            </div>
        </div>

        <!-- –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –±–æ—Ç–∞ -->
        <div class="settings-section" id="bot-settings" style="display: none;">
            <div class="card mb-4">
                <div class="card-header">
                    <h5 class="mb-0">
                        <i class="fas fa-cog me-2"></i>–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –±–æ—Ç–∞
                    </h5>
                </div>
                <div class="card-body">
                    <div class="mb-3">
                        <label for="welcome-message" class="form-label">–ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ</label>
                        <textarea class="form-control" id="welcome-message" name="welcome_message" rows="4" placeholder="–¢–µ–∫—Å—Ç –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏—è –¥–ª—è –Ω–æ–≤—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π...">ü§ñ –ü—Ä–∏–≤–µ—Ç! –Ø –±–æ—Ç-–≤–∏–∑–∏—Ç–∫–∞ —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞ –±–æ—Ç–æ–≤.

–Ø –ø–æ–º–æ–≥—É –≤–∞–º:
‚Ä¢ üìã –°–æ–∑–¥–∞—Ç—å —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –∑–∞–¥–∞–Ω–∏–µ
‚Ä¢ üí¨ –ü–æ–ª—É—á–∏—Ç—å –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏—é
‚Ä¢ üìÇ –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ø–æ—Ä—Ç—Ñ–æ–ª–∏–æ
‚Ä¢ üí∞ –£–∑–Ω–∞—Ç—å —Å—Ç–æ–∏–º–æ—Å—Ç—å –ø—Ä–æ–µ–∫—Ç–∞

–í—ã–±–µ—Ä–∏—Ç–µ –Ω—É–∂–Ω—ã–π —Ä–∞–∑–¥–µ–ª –≤ –º–µ–Ω—é –Ω–∏–∂–µ!</textarea>
                    </div>

                    <div class="row">
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label for="bot-name" class="form-label">–ò–º—è –±–æ—Ç–∞</label>
                                <input type="text" class="form-control" id="bot-name" name="bot_name" value="BotDev Assistant" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ –≤–∞—à–µ–≥–æ –±–æ—Ç–∞">
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label for="developer-name" class="form-label">–ò–º—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞</label>
                                <input type="text" class="form-control" id="developer-name" name="developer_name" value="–í–∞—à–µ –∏–º—è" placeholder="–í–∞—à–µ –∏–º—è">
                            </div>
                        </div>
                    </div>

                    <div class="row">
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label for="contact-telegram" class="form-label">Telegram –¥–ª—è —Å–≤—è–∑–∏</label>
                                <input type="text" class="form-control" id="contact-telegram" name="contact_telegram" value="@your_username" placeholder="@your_username">
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label for="contact-email" class="form-label">Email –¥–ª—è —Å–≤—è–∑–∏</label>
                                <input type="email" class="form-control" id="contact-email" name="contact_email" value="your@email.com" placeholder="your@email.com">
                            </div>
                        </div>
                    </div>

                    <div class="mb-3">
                        <label for="about-text" class="form-label">–û —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–µ</label>
                        <textarea class="form-control" id="about-text" name="about_text" rows="4" placeholder="–†–∞—Å—Å–∫–∞–∂–∏—Ç–µ –æ —Å–µ–±–µ...">–û–ø—ã—Ç–Ω—ã–π —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫ Telegram-–±–æ—Ç–æ–≤ —Å –æ–ø—ã—Ç–æ–º —Ä–∞–±–æ—Ç—ã –±–æ–ª–µ–µ 3 –ª–µ—Ç. –°–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä—É—é—Å—å –Ω–∞ —Å–æ–∑–¥–∞–Ω–∏–∏ –±–æ—Ç–æ–≤ –¥–ª—è –±–∏–∑–Ω–µ—Å–∞, –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ –∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å –≤–Ω–µ—à–Ω–∏–º–∏ —Å–µ—Ä–≤–∏—Å–∞–º–∏.</textarea>
                    </div>

                    <div class="row">
                        <div class="col-md-6">
                            <div class="form-check form-switch mb-3">
                                <input class="form-check-input" type="checkbox" id="maintenance-mode" name="maintenance_mode">
                                <label class="form-check-label" for="maintenance-mode">
                                    –†–µ–∂–∏–º –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è
                                </label>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="form-check form-switch mb-3">
                                <input class="form-check-input" type="checkbox" id="auto-responses" name="auto_responses" checked>
                                <label class="form-check-label" for="auto-responses">
                                    –ê–≤—Ç–æ–æ—Ç–≤–µ—Ç—ã
                                </label>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- –¶–µ–Ω–æ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ -->
        <div class="settings-section" id="pricing-settings" style="display: none;">
            <div class="card mb-4">
                <div class="card-header">
                    <h5 class="mb-0">
                        <i class="fas fa-dollar-sign me-2"></i>–¶–µ–Ω–æ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ
                    </h5>
                </div>
                <div class="card-body">
                    <div class="row">
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label for="base-hourly-rate" class="form-label">–ë–∞–∑–æ–≤–∞—è —Å—Ç–∞–≤–∫–∞ (‚ÇΩ/—á–∞—Å)</label>
                                <input type="number" class="form-control" id="base-hourly-rate" name="base_hourly_rate" value="1000" min="100" step="50">
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label for="currency" class="form-label">–í–∞–ª—é—Ç–∞</label>
                                <select class="form-select" id="currency" name="currency">
                                    <option value="RUB">‚ÇΩ –†—É–±–ª—å</option>
                                    <option value="USD">$ –î–æ–ª–ª–∞—Ä</option>
                                    <option value="EUR">‚Ç¨ –ï–≤—Ä–æ</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <h6 class="mb-3">–ú–Ω–æ–∂–∏—Ç–µ–ª–∏ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏</h6>
                    <div class="row">
                        <div class="col-md-3">
                            <div class="mb-3">
                                <label for="simple-multiplier" class="form-label">–ü—Ä–æ—Å—Ç–æ–π (x)</label>
                                <input type="number" class="form-control" id="simple-multiplier" name="simple_multiplier" value="1.0" min="0.5" max="5" step="0.1">
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="mb-3">
                                <label for="medium-multiplier" class="form-label">–°—Ä–µ–¥–Ω–∏–π (x)</label>
                                <input type="number" class="form-control" id="medium-multiplier" name="medium_multiplier" value="1.5" min="0.5" max="5" step="0.1">
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="mb-3">
                                <label for="complex-multiplier" class="form-label">–°–ª–æ–∂–Ω—ã–π (x)</label>
                                <input type="number" class="form-control" id="complex-multiplier" name="complex_multiplier" value="2.5" min="0.5" max="5" step="0.1">
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="mb-3">
                                <label for="premium-multiplier" class="form-label">–ü—Ä–µ–º–∏—É–º (x)</label>
                                <input type="number" class="form-control" id="premium-multiplier" name="premium_multiplier" value="4.0" min="0.5" max="5" step="0.1">
                            </div>
                        </div>
                    </div>

                    <div class="row">
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label for="urgent-multiplier" class="form-label">–ú–Ω–æ–∂–∏—Ç–µ–ª—å —Å—Ä–æ—á–Ω–æ—Å—Ç–∏</label>
                                <input type="number" class="form-control" id="urgent-multiplier" name="urgent_multiplier" value="1.3" min="1.0" max="3.0" step="0.1">
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label for="min-project-cost" class="form-label">–ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å –ø—Ä–æ–µ–∫—Ç–∞</label>
                                <input type="number" class="form-control" id="min-project-cost" name="min_project_cost" value="5000" min="1000" step="500">
                            </div>
                        </div>
                    </div>

                    <h6 class="mb-3">–ü—Ä–∏–º–µ—Ä—ã —Ü–µ–Ω</h6>
                    <div class="row">
                        <div class="col-md-4">
                            <div class="card bg-light">
                                <div class="card-body text-center">
                                    <h6>–ü—Ä–æ—Å—Ç–æ–π –±–æ—Ç</h6>
                                    <p class="price-example" data-complexity="simple">5 000 - 15 000 ‚ÇΩ</p>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="card bg-light">
                                <div class="card-body text-center">
                                    <h6>–°—Ä–µ–¥–Ω–∏–π –±–æ—Ç</h6>
                                    <p class="price-example" data-complexity="medium">15 000 - 35 000 ‚ÇΩ</p>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="card bg-light">
                                <div class="card-body text-center">
                                    <h6>–°–ª–æ–∂–Ω—ã–π –±–æ—Ç</h6>
                                    <p class="price-example" data-complexity="complex">35 000 - 100 000 ‚ÇΩ</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è -->
        <div class="settings-section" id="notification-settings" style="display: none;">
            <div class="card mb-4">
                <div class="card-header">
                    <h5 class="mb-0">
                        <i class="fas fa-bell me-2"></i>–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
                    </h5>
                </div>
                <div class="card-body">
                    <div class="row">
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label for="admin-chat-id" class="form-label">Telegram Chat ID –∞–¥–º–∏–Ω–∞</label>
                                <input type="text" class="form-control" id="admin-chat-id" name="admin_chat_id" placeholder="123456789">
                                <small class="form-text text-muted">–ü–æ–ª—É—á–∏—Ç–µ ID –Ω–∞–ø–∏—Å–∞–≤ –±–æ—Ç—É @userinfobot</small>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label for="notification-email" class="form-label">Email –¥–ª—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π</label>
                                <input type="email" class="form-control" id="notification-email" name="notification_email" placeholder="admin@example.com">
                            </div>
                        </div>
                    </div>

                    <h6 class="mb-3">–¢–∏–ø—ã —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π</h6>
                    <div class="row">
                        <div class="col-md-6">
                            <div class="form-check form-switch mb-2">
                                <input class="form-check-input" type="checkbox" id="notify-new-user" name="notify_new_user" checked>
                                <label class="form-check-label" for="notify-new-user">
                                    –ù–æ–≤—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
                                </label>
                            </div>
                            <div class="form-check form-switch mb-2">
                                <input class="form-check-input" type="checkbox" id="notify-new-project" name="notify_new_project" checked>
                                <label class="form-check-label" for="notify-new-project">
                                    –ù–æ–≤—ã–π –ø—Ä–æ–µ–∫—Ç
                                </label>
                            </div>
                            <div class="form-check form-switch mb-2">
                                <input class="form-check-input" type="checkbox" id="notify-message" name="notify_message" checked>
                                <label class="form-check-label" for="notify-message">
                                    –ù–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
                                </label>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="form-check form-switch mb-2">
                                <input class="form-check-input" type="checkbox" id="notify-consultant" name="notify_consultant">
                                <label class="form-check-label" for="notify-consultant">
                                    –í–æ–ø—Ä–æ—Å—ã –∫–æ–Ω—Å—É–ª—å—Ç–∞–Ω—Ç—É
                                </label>
                            </div>
                            <div class="form-check form-switch mb-2">
                                <input class="form-check-input" type="checkbox" id="notify-errors" name="notify_errors" checked>
                                <label class="form-check-label" for="notify-errors">
                                    –û—à–∏–±–∫–∏ —Å–∏—Å—Ç–µ–º—ã
                                </label>
                            </div>
                            <div class="form-check form-switch mb-2">
                                <input class="form-check-input" type="checkbox" id="notify-daily-report" name="notify_daily_report">
                                <label class="form-check-label" for="notify-daily-report">
                                    –ï–∂–µ–¥–Ω–µ–≤–Ω—ã–µ –æ—Ç—á–µ—Ç—ã
                                </label>
                            </div>
                        </div>
                    </div>

                    <div class="row">
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label for="notification-time" class="form-label">–í—Ä–µ–º—è –æ—Ç—á–µ—Ç–æ–≤</label>
                                <input type="time" class="form-control" id="notification-time" name="notification_time" value="09:00">
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label for="quiet-hours-start" class="form-label">–¢–∏—Ö–∏–µ —á–∞—Å—ã (—Å)</label>
                                <input type="time" class="form-control" id="quiet-hours-start" name="quiet_hours_start" value="23:00">
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å -->
        <div class="settings-section" id="security-settings" style="display: none;">
            <div class="card mb-4">
                <div class="card-header">
                    <h5 class="mb-0">
                        <i class="fas fa-shield-alt me-2"></i>–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
                    </h5>
                </div>
                <div class="card-body">
                    <div class="row">
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label for="rate-limit" class="form-label">–õ–∏–º–∏—Ç –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ –º–∏–Ω—É—Ç—É</label>
                                <input type="number" class="form-control" id="rate-limit" name="rate_limit" value="20" min="1" max="100">
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label for="session-timeout" class="form-label">–¢–∞–π–º–∞—É—Ç —Å–µ—Å—Å–∏–∏ (–º–∏–Ω)</label>
                                <input type="number" class="form-control" id="session-timeout" name="session_timeout" value="30" min="5" max="120">
                            </div>
                        </div>
                    </div>

                    <div class="mb-3">
                        <label for="blocked-words" class="form-label">–ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Å–ª–æ–≤–∞</label>
                        <textarea class="form-control" id="blocked-words" name="blocked_words" rows="3" placeholder="–í–≤–µ–¥–∏—Ç–µ —Å–ª–æ–≤–∞ —á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é..."></textarea>
                        <small class="form-text text-muted">–°–æ–æ–±—â–µ–Ω–∏—è —Å —ç—Ç–∏–º–∏ —Å–ª–æ–≤–∞–º–∏ –±—É–¥—É—Ç –±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å—Å—è</small>
                    </div>

                    <div class="row">
                        <div class="col-md-6">
                            <div class="form-check form-switch mb-2">
                                <input class="form-check-input" type="checkbox" id="enable-captcha" name="enable_captcha">
                                <label class="form-check-label" for="enable-captcha">
                                    –í–∫–ª—é—á–∏—Ç—å –∫–∞–ø—á—É
                                </label>
                            </div>
                            <div class="form-check form-switch mb-2">
                                <input class="form-check-input" type="checkbox" id="log-messages" name="log_messages" checked>
                                <label class="form-check-label" for="log-messages">
                                    –õ–æ–≥–∏—Ä–æ–≤–∞—Ç—å —Å–æ–æ–±—â–µ–Ω–∏—è
                                </label>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="form-check form-switch mb-2">
                                <input class="form-check-input" type="checkbox" id="auto-ban" name="auto_ban">
                                <label class="form-check-label" for="auto-ban">
                                    –ê–≤—Ç–æ–±–∞–Ω —Å–ø–∞–º–µ—Ä–æ–≤
                                </label>
                            </div>
                            <div class="form-check form-switch mb-2">
                                <input class="form-check-input" type="checkbox" id="require-phone" name="require_phone">
                                <label class="form-check-label" for="require-phone">
                                    –¢—Ä–µ–±–æ–≤–∞—Ç—å —Ç–µ–ª–µ—Ñ–æ–Ω
                                </label>
                            </div>
                        </div>
                    </div>

                    <div class="alert alert-warning">
                        <i class="fas fa-exclamation-triangle me-2"></i>
                        <strong>–í–Ω–∏–º–∞–Ω–∏–µ:</strong> –ò–∑–º–µ–Ω–µ–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–∫ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –º–æ–∂–µ—Ç –ø–æ–≤–ª–∏—è—Ç—å –Ω–∞ —Ä–∞–±–æ—Ç—É –±–æ—Ç–∞. –¢–µ—Å—Ç–∏—Ä—É–π—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–µ—Ä–µ–¥ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ–º.
                    </div>
                </div>
            </div>
        </div>

        <!-- –í–Ω–µ—à–Ω–∏–π –≤–∏–¥ -->
        <div class="settings-section" id="appearance-settings" style="display: none;">
            <div class="card mb-4">
                <div class="card-header">
                    <h5 class="mb-0">
                        <i class="fas fa-palette me-2"></i>–í–Ω–µ—à–Ω–∏–π –≤–∏–¥
                    </h5>
                </div>
                <div class="card-body">
                    <div class="row">
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label for="theme-color" class="form-label">–û—Å–Ω–æ–≤–Ω–æ–π —Ü–≤–µ—Ç</label>
                                <input type="color" class="form-control form-control-color" id="theme-color" name="theme_color" value="#667eea">
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label for="accent-color" class="form-label">–ê–∫—Ü–µ–Ω—Ç–Ω—ã–π —Ü–≤–µ—Ç</label>
                                <input type="color" class="form-control form-control-color" id="accent-color" name="accent_color" value="#764ba2">
                            </div>
                        </div>
                    </div>

                    <div class="mb-3">
                        <label for="logo-url" class="form-label">URL –ª–æ–≥–æ—Ç–∏–ø–∞</label>
                        <input type="url" class="form-control" id="logo-url" name="logo_url" placeholder="https://example.com/logo.png">
                    </div>

                    <div class="row">
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label for="button-style" class="form-label">–°—Ç–∏–ª—å –∫–Ω–æ–ø–æ–∫</label>
                                <select class="form-select" id="button-style" name="button_style">
                                    <option value="rounded">–ó–∞–∫—Ä—É–≥–ª–µ–Ω–Ω—ã–µ</option>
                                    <option value="square">–ü—Ä—è–º–æ—É–≥–æ–ª—å–Ω—ã–µ</option>
                                    <option value="pill">–û–≤–∞–ª—å–Ω—ã–µ</option>
                                </select>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label for="animation-speed" class="form-label">–°–∫–æ—Ä–æ—Å—Ç—å –∞–Ω–∏–º–∞—Ü–∏–∏</label>
                                <select class="form-select" id="animation-speed" name="animation_speed">
                                    <option value="slow">–ú–µ–¥–ª–µ–Ω–Ω–æ</option>
                                    <option value="normal" selected>–ù–æ—Ä–º–∞–ª—å–Ω–æ</option>
                                    <option value="fast">–ë—ã—Å—Ç—Ä–æ</option>
                                    <option value="none">–ë–µ–∑ –∞–Ω–∏–º–∞—Ü–∏–∏</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <div class="mb-3">
                        <label for="custom-css" class="form-label">–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π CSS</label>
                        <textarea class="form-control" id="custom-css" name="custom_css" rows="5" placeholder="/* –í–∞—à –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π CSS */"></textarea>
                    </div>

                    <div class="form-check form-switch">
                        <input class="form-check-input" type="checkbox" id="dark-mode" name="dark_mode">
                        <label class="form-check-label" for="dark-mode">
                            –¢–µ–º–Ω–∞—è —Ç–µ–º–∞
                        </label>
                    </div>
                </div>
            </div>
        </div>

        <!-- –ê–Ω–∞–ª–∏—Ç–∏–∫–∞ -->
        <div class="settings-section" id="analytics-settings" style="display: none;">
            <div class="card mb-4">
                <div class="card-header">
                    <h5 class="mb-0">
                        <i class="fas fa-chart-bar me-2"></i>–ê–Ω–∞–ª–∏—Ç–∏–∫–∞
                    </h5>
                </div>
                <div class="card-body">
                    <div class="row">
                        <div class="col-md-6">
                            <div class="form-check form-switch mb-3">
                                <input class="form-check-input" type="checkbox" id="enable-analytics" name="enable_analytics" checked>
                                <label class="form-check-label" for="enable-analytics">
                                    –í–∫–ª—é—á–∏—Ç—å –∞–Ω–∞–ª–∏—Ç–∏–∫—É
                                </label>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="form-check form-switch mb-3">
                                <input class="form-check-input" type="checkbox" id="track-user-actions" name="track_user_actions" checked>
                                <label class="form-check-label" for="track-user-actions">
                                    –û—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å –¥–µ–π—Å—Ç–≤–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
                                </label>
                            </div>
                        </div>
                    </div>

                    <div class="row">
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label for="retention-days" class="form-label">–•—Ä–∞–Ω–∏—Ç—å –¥–∞–Ω–Ω—ã–µ (–¥–Ω–µ–π)</label>
                                <input type="number" class="form-control" id="retention-days" name="retention_days" value="365" min="30" max="1095">
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label for="report-frequency" class="form-label">–ß–∞—Å—Ç–æ—Ç–∞ –æ—Ç—á–µ—Ç–æ–≤</label>
                                <select class="form-select" id="report-frequency" name="report_frequency">
                                    <option value="daily">–ï–∂–µ–¥–Ω–µ–≤–Ω–æ</option>
                                    <option value="weekly" selected>–ï–∂–µ–Ω–µ–¥–µ–ª—å–Ω–æ</option>
                                    <option value="monthly">–ï–∂–µ–º–µ—Å—è—á–Ω–æ</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <h6 class="mb-3">–¶–µ–ª–∏ –∫–æ–Ω–≤–µ—Ä—Å–∏–∏</h6>
                    <div class="row">
                        <div class="col-md-4">
                            <div class="mb-3">
                                <label for="goal-consultation" class="form-label">–ö–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏—è (‚ÇΩ)</label>
                                <input type="number" class="form-control" id="goal-consultation" name="goal_consultation" value="500" min="0">
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="mb-3">
                                <label for="goal-tz-creation" class="form-label">–°–æ–∑–¥–∞–Ω–∏–µ –¢–ó (‚ÇΩ)</label>
                                <input type="number" class="form-control" id="goal-tz-creation" name="goal_tz_creation" value="1000" min="0">
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="mb-3">
                                <label for="goal-project" class="form-label">–ü—Ä–æ–µ–∫—Ç (‚ÇΩ)</label>
                                <input type="number" class="form-control" id="goal-project" name="goal_project" value="15000" min="0">
                            </div>
                        </div>
                    </div>

                    <div class="mb-3">
                        <label for="custom-metrics" class="form-label">–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏</label>
                        <textarea class="form-control" id="custom-metrics" name="custom_metrics" rows="3" placeholder="–í–≤–µ–¥–∏—Ç–µ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏ —á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é...">–≤—Ä–µ–º—è_–æ—Ç–≤–µ—Ç–∞, –ø–æ–ø—É–ª—è—Ä–Ω—ã–µ_—Ñ—É–Ω–∫—Ü–∏–∏, –∏—Å—Ç–æ—á–Ω–∏–∫–∏_—Ç—Ä–∞—Ñ–∏–∫–∞</textarea>
                    </div>

                    <div class="row">
                        <div class="col-md-6">
                            <div class="form-check form-switch mb-2">
                                <input class="form-check-input" type="checkbox" id="export-analytics" name="export_analytics" checked>
                                <label class="form-check-label" for="export-analytics">
                                    –†–∞–∑—Ä–µ—à–∏—Ç—å —ç–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö
                                </label>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="form-check form-switch mb-2">
                                <input class="form-check-input" type="checkbox" id="anonymous-analytics" name="anonymous_analytics">
                                <label class="form-check-label" for="anonymous-analytics">
                                    –ê–Ω–æ–Ω–∏–º–Ω–∞—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞
                                </label>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ -->
        <div class="settings-section" id="integrations-settings" style="display: none;">
            <div class="card mb-4">
                <div class="card-header">
                    <h5 class="mb-0">
                        <i class="fas fa-plug me-2"></i>–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏
                    </h5>
                </div>
                <div class="card-body">
                    <h6 class="mb-3">API –ö–ª—é—á–∏</h6>
                    <div class="row">
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label for="openrouter-key" class="form-label">OpenRouter API Key</label>
                                <div class="input-group">
                                    <input type="password" class="form-control" id="openrouter-key" name="openrouter_key" placeholder="sk-or-v1-...">
                                    <button class="btn btn-outline-secondary" type="button" onclick="togglePassword('openrouter-key')">
                                        <i class="fas fa-eye"></i>
                                    </button>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label for="openai-key" class="form-label">OpenAI API Key</label>
                                <div class="input-group">
                                    <input type="password" class="form-control" id="openai-key" name="openai_key" placeholder="sk-...">
                                    <button class="btn btn-outline-secondary" type="button" onclick="togglePassword('openai-key')">
                                        <i class="fas fa-eye"></i>
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="row">
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label for="speech-api-key" class="form-label">Speech API Key</label>
                                <input type="password" class="form-control" id="speech-api-key" name="speech_api_key" placeholder="–ö–ª—é—á –¥–ª—è —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è —Ä–µ—á–∏">
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label for="webhook-url" class="form-label">Webhook URL</label>
                                <input type="url" class="form-control" id="webhook-url" name="webhook_url" placeholder="https://your-app.com/webhook">
                            </div>
                        </div>
                    </div>

                    <h6 class="mb-3">–í–Ω–µ—à–Ω–∏–µ —Å–µ—Ä–≤–∏—Å—ã</h6>
                    <div class="row">
                        <div class="col-md-6">
                            <div class="form-check form-switch mb-3">
                                <input class="form-check-input" type="checkbox" id="enable-google-drive" name="enable_google_drive">
                                <label class="form-check-label" for="enable-google-drive">
                                    Google Drive –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è
                                </label>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="form-check form-switch mb-3">
                                <input class="form-check-input" type="checkbox" id="enable-dropbox" name="enable_dropbox">
                                <label class="form-check-label" for="enable-dropbox">
                                    Dropbox –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è
                                </label>
                            </div>
                        </div>
                    </div>

                    <div class="row">
                        <div class="col-md-6">
                            <div class="form-check form-switch mb-3">
                                <input class="form-check-input" type="checkbox" id="enable-email" name="enable_email">
                                <label class="form-check-label" for="enable-email">
                                    Email —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
                                </label>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="form-check form-switch mb-3">
                                <input class="form-check-input" type="checkbox" id="enable-sms" name="enable_sms">
                                <label class="form-check-label" for="enable-sms">
                                    SMS —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
                                </label>
                            </div>
                        </div>
                    </div>

                    <div class="mb-3">
                        <label for="smtp-settings" class="form-label">SMTP –Ω–∞—Å—Ç—Ä–æ–π–∫–∏</label>
                        <textarea class="form-control" id="smtp-settings" name="smtp_settings" rows="4" placeholder='{"host": "smtp.gmail.com", "port": 587, "username": "your@email.com", "password": "your_password"}'></textarea>
                        <small class="form-text text-muted">JSON —Ñ–æ—Ä–º–∞—Ç —Å –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏ SMTP —Å–µ—Ä–≤–µ—Ä–∞</small>
                    </div>

                    <h6 class="mb-3">–õ–∏–º–∏—Ç—ã API</h6>
                    <div class="row">
                        <div class="col-md-4">
                            <div class="mb-3">
                                <label for="ai-daily-limit" class="form-label">AI –∑–∞–ø—Ä–æ—Å—ã/–¥–µ–Ω—å</label>
                                <input type="number" class="form-control" id="ai-daily-limit" name="ai_daily_limit" value="1000" min="10">
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="mb-3">
                                <label for="speech-daily-limit" class="form-label">–†–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ —Ä–µ—á–∏/–¥–µ–Ω—å</label>
                                <input type="number" class="form-control" id="speech-daily-limit" name="speech_daily_limit" value="100" min="5">
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="mb-3">
                                <label for="file-daily-limit" class="form-label">–û–±—Ä–∞–±–æ—Ç–∫–∞ —Ñ–∞–π–ª–æ–≤/–¥–µ–Ω—å</label>
                                <input type="number" class="form-control" id="file-daily-limit" name="file_daily_limit" value="50" min="5">
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —ç–∫—Å–ø–æ—Ä—Ç–∞ –Ω–∞—Å—Ç—Ä–æ–µ–∫ -->
<div class="modal fade" id="exportModal" tabindex="-1">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">–≠–∫—Å–ø–æ—Ä—Ç –Ω–∞—Å—Ç—Ä–æ–µ–∫</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <p>–í—ã–±–µ—Ä–∏—Ç–µ —Ñ–æ—Ä–º–∞—Ç —ç–∫—Å–ø–æ—Ä—Ç–∞:</p>
                <div class="d-grid gap-2">
                    <button class="btn btn-outline-primary" onclick="exportSettings('json')">
                        <i class="fas fa-file-code me-2"></i>JSON
                    </button>
                    <button class="btn btn-outline-success" onclick="exportSettings('env')">
                        <i class="fas fa-file-alt me-2"></i>.env —Ñ–∞–π–ª
                    </button>
                    <button class="btn btn-outline-info" onclick="exportSettings('yaml')">
                        <i class="fas fa-file-text me-2"></i>YAML
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Å–±—Ä–æ—Å–∞ –Ω–∞—Å—Ç—Ä–æ–µ–∫ -->
<div class="modal fade" id="resetModal" tabindex="-1">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">–°–±—Ä–æ—Å –Ω–∞—Å—Ç—Ä–æ–µ–∫</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <div class="alert alert-warning">
                    <i class="fas fa-exclamation-triangle me-2"></i>
                    <strong>–í–Ω–∏–º–∞–Ω–∏–µ!</strong> –í—Å–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –±—É–¥—É—Ç —Å–±—Ä–æ—à–µ–Ω—ã –∫ –∑–Ω–∞—á–µ–Ω–∏—è–º –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é. –≠—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ –Ω–µ–ª—å–∑—è –æ—Ç–º–µ–Ω–∏—Ç—å.
                </div>
                <p>–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —Å–±—Ä–æ—Å–∏—Ç—å –≤—Å–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏?</p>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">–û—Ç–º–µ–Ω–∞</button>
                <button type="button" class="btn btn-danger" onclick="confirmReset()">–°–±—Ä–æ—Å–∏—Ç—å</button>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
document.addEventListener('DOMContentLoaded', function() {
    // –ù–∞–≤–∏–≥–∞—Ü–∏—è –ø–æ —Ä–∞–∑–¥–µ–ª–∞–º
    document.querySelectorAll('.settings-nav-link').forEach(link => {
        link.addEventListener('click', function(e) {
            e.preventDefault();
            
            // –£–±–∏—Ä–∞–µ–º –∞–∫—Ç–∏–≤–Ω—ã–π –∫–ª–∞—Å—Å —É –≤—Å–µ—Ö —Å—Å—ã–ª–æ–∫
            document.querySelectorAll('.settings-nav-link').forEach(l => l.classList.remove('active'));
            
            // –î–æ–±–∞–≤–ª—è–µ–º –∞–∫—Ç–∏–≤–Ω—ã–π –∫–ª–∞—Å—Å –∫ —Ç–µ–∫—É—â–µ–π —Å—Å—ã–ª–∫–µ
            this.classList.add('active');
            
            // –°–∫—Ä—ã–≤–∞–µ–º –≤—Å–µ —Å–µ–∫—Ü–∏–∏
            document.querySelectorAll('.settings-section').forEach(section => {
                section.style.display = 'none';
            });
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –≤—ã–±—Ä–∞–Ω–Ω—É—é —Å–µ–∫—Ü–∏—é
            const section = this.dataset.section;
            document.getElementById(section + '-settings').style.display = 'block';
        });
    });

    // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã
    const temperatureSlider = document.getElementById('ai-temperature');
    const temperatureValue = document.getElementById('temperature-value');
    
    temperatureSlider.addEventListener('input', function() {
        temperatureValue.textContent = this.value;
    });

    // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–∏–º–µ—Ä–æ–≤ —Ü–µ–Ω
    updatePriceExamples();
    
    // –°–ª—É—à–∞—Ç–µ–ª–∏ –¥–ª—è –ø–æ–ª–µ–π —Ü–µ–Ω–æ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è
    ['base-hourly-rate', 'simple-multiplier', 'medium-multiplier', 'complex-multiplier'].forEach(id => {
        document.getElementById(id).addEventListener('input', updatePriceExamples);
    });

    // –ó–∞–≥—Ä—É–∑–∫–∞ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –Ω–∞—Å—Ç—Ä–æ–µ–∫
    loadSettings();
});

function updatePriceExamples() {
    const baseRate = parseFloat(document.getElementById('base-hourly-rate').value) || 1000;
    const multipliers = {
        simple: parseFloat(document.getElementById('simple-multiplier').value) || 1.0,
        medium: parseFloat(document.getElementById('medium-multiplier').value) || 1.5,
        complex: parseFloat(document.getElementById('complex-multiplier').value) || 2.5
    };

    const examples = {
        simple: { min: 5, max: 15 },
        medium: { min: 15, max: 35 },
        complex: { min: 35, max: 100 }
    };

    Object.keys(examples).forEach(complexity => {
        const element = document.querySelector(`[data-complexity="${complexity}"]`);
        if (element) {
            const minPrice = Math.round((baseRate * multipliers[complexity] * examples[complexity].min) / 1000) * 1000;
            const maxPrice = Math.round((baseRate * multipliers[complexity] * examples[complexity].max) / 1000) * 1000;
            element.textContent = `${formatCurrency(minPrice)} - ${formatCurrency(maxPrice)}`;
        }
    });
}

async function loadSettings() {
    try {
        const response = await makeRequest('/admin/api/settings');
        if (response.success) {
            const settings = response.data;
            
            // –ó–∞–ø–æ–ª–Ω—è–µ–º –ø–æ–ª—è –Ω–∞—Å—Ç—Ä–æ–µ–∫
            Object.keys(settings).forEach(key => {
                const element = document.querySelector(`[name="${key}"]`);
                if (element) {
                    if (element.type === 'checkbox') {
                        element.checked = settings[key] === 'true' || settings[key] === true;
                    } else {
                        element.value = settings[key] || '';
                    }
                }
            });
            
            updatePriceExamples();
        }
    } catch (error) {
        console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –Ω–∞—Å—Ç—Ä–æ–µ–∫:', error);
    }
}

async function saveAllSettings() {
    const settingsData = {};
    const form = document.querySelector('.main-content');
    const inputs = form.querySelectorAll('input, select, textarea');
    
    inputs.forEach(input => {
        if (input.name) {
            if (input.type === 'checkbox') {
                settingsData[input.name] = input.checked;
            } else {
                settingsData[input.name] = input.value;
            }
        }
    });

    try {
        setLoading(document.querySelector('.main-content'), true);
        
        const response = await makeRequest('/admin/api/settings/bulk-update', {
            method: 'POST',
            body: JSON.stringify(settingsData)
        });
        
        if (response.success) {
            showNotification('–ù–∞—Å—Ç—Ä–æ–π–∫–∏ —É—Å–ø–µ—à–Ω–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã', 'success');
        } else {
            showNotification('–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ –Ω–∞—Å—Ç—Ä–æ–µ–∫: ' + response.error, 'danger');
        }
    } catch (error) {
        showNotification('–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ –Ω–∞—Å—Ç—Ä–æ–µ–∫', 'danger');
    } finally {
        setLoading(document.querySelector('.main-content'), false);
    }
}

function resetToDefaults() {
    const modal = new bootstrap.Modal(document.getElementById('resetModal'));
    modal.show();
}

async function confirmReset() {
    try {
        const response = await makeRequest('/admin/api/settings/reset', {
            method: 'POST'
        });
        
        if (response.success) {
            showNotification('–ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–±—Ä–æ—à–µ–Ω—ã –∫ –∑–Ω–∞—á–µ–Ω–∏—è–º –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é', 'success');
            setTimeout(() => location.reload(), 2000);
        } else {
            showNotification('–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–±—Ä–æ—Å–µ –Ω–∞—Å—Ç—Ä–æ–µ–∫: ' + response.error, 'danger');
        }
    } catch (error) {
        showNotification('–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–±—Ä–æ—Å–µ –Ω–∞—Å—Ç—Ä–æ–µ–∫', 'danger');
    }
    
    bootstrap.Modal.getInstance(document.getElementById('resetModal')).hide();
}

function exportSettings(format = 'json') {
    const modal = format ? null : new bootstrap.Modal(document.getElementById('exportModal'));
    
    if (!format) {
        modal.show();
        return;
    }

    const settingsData = {};
    const inputs = document.querySelectorAll('input, select, textarea');
    
    inputs.forEach(input => {
        if (input.name) {
            if (input.type === 'checkbox') {
                settingsData[input.name] = input.checked;
            } else {
                settingsData[input.name] = input.value;
            }
        }
    });

    let content, filename, mimeType;
    
    switch (format) {
        case 'json':
            content = JSON.stringify(settingsData, null, 2);
            filename = 'bot-settings.json';
            mimeType = 'application/json';
            break;
        case 'env':
            content = Object.keys(settingsData)
                .map(key => `${key.toUpperCase()}=${settingsData[key]}`)
                .join('\n');
            filename = 'bot-settings.env';
            mimeType = 'text/plain';
            break;
        case 'yaml':
            content = Object.keys(settingsData)
                .map(key => `${key}: ${JSON.stringify(settingsData[key])}`)
                .join('\n');
            filename = 'bot-settings.yaml';
            mimeType = 'text/yaml';
            break;
    }

    const blob = new Blob([content], { type: mimeType });
    const url = window.URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url;
    a.download = filename;
    document.body.appendChild(a);
    a.click();
    document.body.removeChild(a);
    window.URL.revokeObjectURL(url);

    if (modal) modal.hide();
    showNotification(`–ù–∞—Å—Ç—Ä–æ–π–∫–∏ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω—ã –≤ ${format.toUpperCase()}`, 'success');
}

function togglePassword(inputId) {
    const input = document.getElementById(inputId);
    const button = input.nextElementSibling;
    const icon = button.querySelector('i');
    
    if (input.type === 'password') {
        input.type = 'text';
        icon.classList.remove('fa-eye');
        icon.classList.add('fa-eye-slash');
    } else {
        input.type = 'password';
        icon.classList.remove('fa-eye-slash');
        icon.classList.add('fa-eye');
    }
}

// –ê–≤—Ç–æ—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –∫–ª—é—á–µ–≤—ã—Ö –Ω–∞—Å—Ç—Ä–æ–µ–∫
document.addEventListener('change', function(e) {
    if (e.target.matches('input[name*="api"], input[name*="key"], input[name*="token"]')) {
        // –ê–≤—Ç–æ—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–ª—è –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –Ω–∞—Å—Ç—Ä–æ–µ–∫
        const settingKey = e.target.name;
        const settingValue = e.target.type === 'checkbox' ? e.target.checked : e.target.value;
        
        makeRequest('/admin/api/settings/update', {
            method: 'POST',
            body: JSON.stringify({
                key: settingKey,
                value: settingValue
            })
        }).then(response => {
            if (response.success) {
                showNotification('–ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞', 'success');
            }
        }).catch(error => {
            showNotification('–û—à–∏–±–∫–∞ –∞–≤—Ç–æ—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è', 'warning');
        });
    }
});

// –í–∞–ª–∏–¥–∞—Ü–∏—è –Ω–∞—Å—Ç—Ä–æ–µ–∫ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
function validateSettings() {
    const requiredFields = [
        'ai-provider',
        'ai-model',
        'base-hourly-rate'
    ];
    
    let isValid = true;
    
    requiredFields.forEach(fieldId => {
        const field = document.getElementById(fieldId);
        if (!field.value) {
            field.classList.add('is-invalid');
            isValid = false;
        } else {
            field.classList.remove('is-invalid');
        }
    });
    
    return isValid;
}

// –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è —Å AI API
async function testAIConnection() {
    const provider = document.getElementById('ai-provider').value;
    const model = document.getElementById('ai-model').value;
    const apiKey = provider === 'openrouter' ? 
        document.getElementById('openrouter-key').value : 
        document.getElementById('openai-key').value;
    
    if (!apiKey) {
        showNotification('–í–≤–µ–¥–∏—Ç–µ API –∫–ª—é—á –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è', 'warning');
        return;
    }
    
    try {
        const response = await makeRequest('/api/test-ai-connection', {
            method: 'POST',
            body: JSON.stringify({
                provider: provider,
                model: model,
                api_key: apiKey
            })
        });
        
        if (response.success) {
            showNotification('–°–æ–µ–¥–∏–Ω–µ–Ω–∏–µ —Å AI API —É—Å–ø–µ—à–Ω–æ!', 'success');
        } else {
            showNotification('–û—à–∏–±–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è: ' + response.error, 'danger');
        }
    } catch (error) {
        showNotification('–û—à–∏–±–∫–∞ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è API', 'danger');
    }
}
</script>
{% endblock %}