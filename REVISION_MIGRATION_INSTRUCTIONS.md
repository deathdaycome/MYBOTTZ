# Инструкция по миграции БД для прогресс-бара и таймера правок

## Выполнение миграции

Для добавления прогресс-бара и таймера в правки выполните миграцию:

```bash
python3 migrations/add_revision_progress_timer.py
```

## Что добавлено

### База данных
В таблицу `project_revisions` добавлены три новых поля:
- `progress` (INTEGER) - процент выполнения правки (0-100)
- `time_spent_seconds` (INTEGER) - общее время работы над правкой в секундах
- `timer_started_at` (DATETIME) - время запуска таймера (NULL если таймер не запущен)

### API endpoints
Добавлены новые эндпоинты в `app/admin/routers/revisions.py`:

- `POST /admin/revisions/api/revisions/{revision_id}/progress` - обновление прогресса правки
- `POST /admin/revisions/api/revisions/{revision_id}/timer/start` - запуск таймера
- `POST /admin/revisions/api/revisions/{revision_id}/timer/stop` - остановка таймера

### UI
В [revisions.html](app/admin/templates/revisions.html) добавлены:
- Две новые колонки в таблице правок: "Прогресс" и "Время"
- Визуальный прогресс-бар с процентами (кликабельный для изменения)
- Таймер с кнопками запуска/остановки
- Автоматическое обновление таймера в реальном времени для запущенных правок

### Дизайн
- Минималистичный современный дизайн в фиолетовых тонах
- Тонкий прогресс-бар (8px) с градиентом
- Компактный таймер с иконками
- Плавные анимации и переходы
- Соответствует дизайну планировщика задач

## Как использовать

1. Откройте страницу правок (`/admin/revisions`)
2. В таблице правок появились две новые колонки
3. Кликните на прогресс-бар чтобы изменить прогресс (откроется промпт с вводом 0-100)
4. Нажмите кнопку play/stop для управления таймером
5. Таймер автоматически обновляется каждую секунду
6. Для завершенных правок отображается только финальный прогресс и время

## Примечания

- Прогресс и таймер доступны только для незавершенных правок
- Таймер сохраняет накопленное время при остановке
- При запуске таймера снова, время продолжает накапливаться
- Изменять прогресс и управлять таймером могут создатель правки или назначенный исполнитель
